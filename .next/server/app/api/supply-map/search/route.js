"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/supply-map/search/route";
exports.ids = ["app/api/supply-map/search/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsupply-map%2Fsearch%2Froute&page=%2Fapi%2Fsupply-map%2Fsearch%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsupply-map%2Fsearch%2Froute.ts&appDir=%2FUsers%2Flakshinjonnala%2FFindR%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flakshinjonnala%2FFindR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsupply-map%2Fsearch%2Froute&page=%2Fapi%2Fsupply-map%2Fsearch%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsupply-map%2Fsearch%2Froute.ts&appDir=%2FUsers%2Flakshinjonnala%2FFindR%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flakshinjonnala%2FFindR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_lakshinjonnala_FindR_app_api_supply_map_search_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/supply-map/search/route.ts */ \"(rsc)/./app/api/supply-map/search/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/supply-map/search/route\",\n        pathname: \"/api/supply-map/search\",\n        filename: \"route\",\n        bundlePath: \"app/api/supply-map/search/route\"\n    },\n    resolvedPagePath: \"/Users/lakshinjonnala/FindR/app/api/supply-map/search/route.ts\",\n    nextConfigOutput,\n    userland: _Users_lakshinjonnala_FindR_app_api_supply_map_search_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/supply-map/search/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdXBwbHktbWFwJTJGc2VhcmNoJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzdXBwbHktbWFwJTJGc2VhcmNoJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc3VwcGx5LW1hcCUyRnNlYXJjaCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmxha3NoaW5qb25uYWxhJTJGRmluZFIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbGFrc2hpbmpvbm5hbGElMkZGaW5kUiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDYztBQUMzRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2ZpbmRyLz9jMmFmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9sYWtzaGluam9ubmFsYS9GaW5kUi9hcHAvYXBpL3N1cHBseS1tYXAvc2VhcmNoL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zdXBwbHktbWFwL3NlYXJjaC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N1cHBseS1tYXAvc2VhcmNoXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zdXBwbHktbWFwL3NlYXJjaC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9sYWtzaGluam9ubmFsYS9GaW5kUi9hcHAvYXBpL3N1cHBseS1tYXAvc2VhcmNoL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdXBwbHktbWFwL3NlYXJjaC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsupply-map%2Fsearch%2Froute&page=%2Fapi%2Fsupply-map%2Fsearch%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsupply-map%2Fsearch%2Froute.ts&appDir=%2FUsers%2Flakshinjonnala%2FFindR%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flakshinjonnala%2FFindR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/supply-map/search/route.ts":
/*!********************************************!*\
  !*** ./app/api/supply-map/search/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_supply_map_overpass__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supply-map/overpass */ \"(rsc)/./lib/supply-map/overpass.ts\");\n/* harmony import */ var _lib_supply_map_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supply-map/ai */ \"(rsc)/./lib/supply-map/ai.ts\");\n/* harmony import */ var _lib_supply_map_feedback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supply-map/feedback */ \"(rsc)/./lib/supply-map/feedback.ts\");\n/* harmony import */ var _lib_supply_map_distance__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/supply-map/distance */ \"(rsc)/./lib/supply-map/distance.ts\");\n/* harmony import */ var _lib_supply_map_google_distance__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/supply-map/google-distance */ \"(rsc)/./lib/supply-map/google-distance.ts\");\n/* harmony import */ var _lib_supply_map_osrm_distance__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/supply-map/osrm-distance */ \"(rsc)/./lib/supply-map/osrm-distance.ts\");\n\n\n\n\n\n\nconst RADIUS_M = 5000 // 5 km\n;\nconst ALTERNATIVES_THRESHOLD = 2 // suggest alternatives when stores < this\n;\nconst MAX_NEARBY_STORES = 10 // number of stores to return\n;\nconst MAX_STORES_FOR_ROAD = 25 // request road distances for more candidates (Google/OSRM limit allows 25)\n;\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const item = typeof body.item === \"string\" ? body.item.trim() : \"\";\n        const lat = typeof body.lat === \"number\" ? body.lat : parseFloat(body.lat);\n        const lng = typeof body.lng === \"number\" ? body.lng : parseFloat(body.lng);\n        if (!item || Number.isNaN(lat) || Number.isNaN(lng)) {\n            return Response.json({\n                message: \"Missing or invalid item, lat, or lng\"\n            }, {\n                status: 400\n            });\n        }\n        const maxDistanceKm = body.filters?.maxDistanceKm;\n        const radiusM = maxDistanceKm != null ? Math.min(maxDistanceKm * 1000, 25000) : RADIUS_M;\n        const stores = await (0,_lib_supply_map_overpass__WEBPACK_IMPORTED_MODULE_0__.fetchNearbyStores)(lat, lng, radiusM);\n        const limitKm = maxDistanceKm != null ? maxDistanceKm : RADIUS_M / 1000;\n        const storeIds = stores.map((s)=>s.id);\n        const prices = (0,_lib_supply_map_feedback__WEBPACK_IMPORTED_MODULE_2__.getPricesForStores)(item, storeIds);\n        let searchStores = stores.filter((s)=>s.distanceKm <= limitKm).map((s)=>({\n                id: s.id,\n                name: s.name,\n                lat: s.lat,\n                lng: s.lng,\n                address: s.address,\n                distanceKm: Math.round((0,_lib_supply_map_distance__WEBPACK_IMPORTED_MODULE_3__.haversineKm)(lat, lng, s.lat, s.lng) * 100) / 100,\n                durationMinutes: undefined,\n                reportedPrice: prices[s.id],\n                osmTags: s.osmTags\n            })).sort((a, b)=>a.distanceKm - b.distanceKm);\n        const storesForRoad = searchStores.slice(0, MAX_STORES_FOR_ROAD);\n        const dests = storesForRoad.map((s)=>({\n                lat: s.lat,\n                lng: s.lng\n            }));\n        let roadDistances = null;\n        let distanceSource = \"haversine\";\n        let googleError;\n        const googleKeySet = Boolean(process.env.GOOGLE_MAPS_API_KEY);\n        if (dests.length > 0) {\n            if (googleKeySet) {\n                const googleResult = await (0,_lib_supply_map_google_distance__WEBPACK_IMPORTED_MODULE_4__.getRoadDistances)({\n                    lat,\n                    lng\n                }, dests);\n                if (googleResult.results) {\n                    roadDistances = googleResult.results;\n                    distanceSource = \"google\";\n                    const hasGaps = roadDistances.some((r)=>r.distanceKm <= 0);\n                    if (hasGaps) {\n                        try {\n                            const osrmResults = await (0,_lib_supply_map_osrm_distance__WEBPACK_IMPORTED_MODULE_5__.getRoadDistancesOSRM)({\n                                lat,\n                                lng\n                            }, dests);\n                            if (osrmResults && osrmResults.length === roadDistances.length) {\n                                roadDistances = roadDistances.map((g, i)=>{\n                                    const o = osrmResults[i];\n                                    if (g.distanceKm > 0) return g;\n                                    if (o?.distanceKm > 0) return o;\n                                    return g;\n                                });\n                            }\n                        } catch  {\n                        // keep Google results with gaps\n                        }\n                    }\n                } else {\n                    googleError = googleResult.error;\n                    if (googleError) console.warn(\"[Supply Map] Google:\", googleError);\n                }\n            } else {\n                googleError = \"GOOGLE_MAPS_API_KEY not set\";\n                console.warn(\"[Supply Map]\", googleError);\n            }\n            if (!roadDistances) {\n                try {\n                    roadDistances = await (0,_lib_supply_map_osrm_distance__WEBPACK_IMPORTED_MODULE_5__.getRoadDistancesOSRM)({\n                        lat,\n                        lng\n                    }, dests);\n                    if (roadDistances) distanceSource = \"osrm\";\n                } catch (err) {\n                    console.error(\"[Supply Map] OSRM threw:\", err);\n                    roadDistances = null;\n                }\n            }\n        }\n        if (roadDistances && roadDistances.length > 0) {\n            // When API returns duration but distance=0 (e.g. OSRM null cell), estimate distance from drive time\n            const AVG_SPEED_KMH = 50;\n            const roadCount = Math.min(roadDistances.length, storesForRoad.length);\n            const withRoad = storesForRoad.slice(0, roadCount).map((s, i)=>{\n                let roadKm = roadDistances[i].distanceKm;\n                const durationMin = roadDistances[i].durationMinutes;\n                if (roadKm <= 0 && durationMin != null && durationMin > 0) {\n                    roadKm = Math.round(durationMin / 60 * AVG_SPEED_KMH * 100) / 100;\n                }\n                const straightKm = (0,_lib_supply_map_distance__WEBPACK_IMPORTED_MODULE_3__.haversineKm)(lat, lng, s.lat, s.lng);\n                // Road distance must be >= straight-line; if API returns nonsense, reject\n                const useRoad = roadKm > 0 && roadKm >= straightKm * 0.5 && roadKm <= straightKm * 15;\n                return {\n                    ...s,\n                    distanceKm: useRoad ? roadKm : 0,\n                    durationMinutes: useRoad ? durationMin : undefined,\n                    hadApiValue: useRoad\n                };\n            });\n            // Only include stores that have a valid road API value; exclude fallback/haversine-only\n            searchStores = withRoad.filter((s)=>s.hadApiValue && s.distanceKm > 0 && s.distanceKm <= limitKm).map(({ hadApiValue: _, ...s })=>s).sort((a, b)=>a.distanceKm - b.distanceKm);\n        } else {\n            // No road API data: exclude all stores so we don't show straight-line estimates\n            searchStores = [];\n        }\n        searchStores = searchStores.slice(0, MAX_NEARBY_STORES);\n        let bestOptionId = searchStores.length > 0 ? searchStores[0].id : \"\";\n        let summary = searchStores.length > 0 ? `${searchStores[0].name} is the closest option (${(0,_lib_supply_map_distance__WEBPACK_IMPORTED_MODULE_3__.formatMiles)(searchStores[0].distanceKm)} away).` : \"No nearby stores found.\";\n        // Phase 2: AI ranking and summary when OPENAI_API_KEY is set (uses stock + price when available)\n        if (process.env.OPENAI_API_KEY && searchStores.length > 0) {\n            const feedback = (0,_lib_supply_map_feedback__WEBPACK_IMPORTED_MODULE_2__.getFeedbackForStores)(item, searchStores.map((s)=>s.id));\n            const rankResult = await (0,_lib_supply_map_ai__WEBPACK_IMPORTED_MODULE_1__.rankStores)(item, searchStores, feedback);\n            if (rankResult?.orderedIds?.length) {\n                const idToStore = new Map(searchStores.map((s)=>[\n                        s.id,\n                        s\n                    ]));\n                const ordered = rankResult.orderedIds.map((id)=>idToStore.get(id)).filter(Boolean);\n                if (ordered.length) {\n                    const rest = searchStores.filter((s)=>!rankResult.orderedIds.includes(s.id));\n                    searchStores = [\n                        ...ordered,\n                        ...rest\n                    ];\n                    bestOptionId = ordered[0].id;\n                    const aiSummary = await (0,_lib_supply_map_ai__WEBPACK_IMPORTED_MODULE_1__.summarizeBestOption)(item, ordered[0], searchStores);\n                    if (aiSummary) summary = aiSummary;\n                }\n            }\n        }\n        // Phase 3: alternative suggestions when no or few results\n        let alternatives;\n        if (searchStores.length < ALTERNATIVES_THRESHOLD && item) {\n            alternatives = await (0,_lib_supply_map_ai__WEBPACK_IMPORTED_MODULE_1__.suggestAlternatives)(item);\n        }\n        const response = {\n            stores: searchStores,\n            bestOptionId,\n            summary,\n            _debug: {\n                distanceSource,\n                googleKeySet,\n                ...googleError ? {\n                    googleError\n                } : {}\n            },\n            ...alternatives?.length ? {\n                alternatives\n            } : {}\n        };\n        return Response.json(response);\n    } catch (err) {\n        console.error(\"Supply map search error:\", err);\n        return Response.json({\n            message: err instanceof Error ? err.message : \"Search failed\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N1cHBseS1tYXAvc2VhcmNoL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFDNkQ7QUFDNkI7QUFDTjtBQUNoQjtBQUNEO0FBQ0U7QUFFckUsTUFBTVUsV0FBVyxLQUFLLE9BQU87O0FBQzdCLE1BQU1DLHlCQUF5QixFQUFFLDBDQUEwQzs7QUFDM0UsTUFBTUMsb0JBQW9CLEdBQUcsNkJBQTZCOztBQUMxRCxNQUFNQyxzQkFBc0IsR0FBRywyRUFBMkU7O0FBNEJuRyxlQUFlQyxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBQy9CLE1BQU1DLE9BQU8sT0FBT0YsS0FBS0UsSUFBSSxLQUFLLFdBQVdGLEtBQUtFLElBQUksQ0FBQ0MsSUFBSSxLQUFLO1FBQ2hFLE1BQU1DLE1BQU0sT0FBT0osS0FBS0ksR0FBRyxLQUFLLFdBQVdKLEtBQUtJLEdBQUcsR0FBR0MsV0FBV0wsS0FBS0ksR0FBRztRQUN6RSxNQUFNRSxNQUFNLE9BQU9OLEtBQUtNLEdBQUcsS0FBSyxXQUFXTixLQUFLTSxHQUFHLEdBQUdELFdBQVdMLEtBQUtNLEdBQUc7UUFFekUsSUFBSSxDQUFDSixRQUFRSyxPQUFPQyxLQUFLLENBQUNKLFFBQVFHLE9BQU9DLEtBQUssQ0FBQ0YsTUFBTTtZQUNuRCxPQUFPRyxTQUFTUixJQUFJLENBQ2xCO2dCQUFFUyxTQUFTO1lBQXVDLEdBQ2xEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNQyxnQkFBZ0JaLEtBQUthLE9BQU8sRUFBRUQ7UUFDcEMsTUFBTUUsVUFBVUYsaUJBQWlCLE9BQU9HLEtBQUtDLEdBQUcsQ0FBQ0osZ0JBQWdCLE1BQU0sU0FBU2xCO1FBRWhGLE1BQU11QixTQUFTLE1BQU1qQywyRUFBaUJBLENBQUNvQixLQUFLRSxLQUFLUTtRQUNqRCxNQUFNSSxVQUFVTixpQkFBaUIsT0FBT0EsZ0JBQWdCbEIsV0FBVztRQUNuRSxNQUFNeUIs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cENWLGVBQWVRLE9BQU8sQ0FBQyxFQUFFLENBQUN6RCxFQUFFO29CQUM1QixNQUFNNkQsWUFBWSxNQUFNakcsdUVBQW1CQSxDQUFDZ0IsTUFBTTZFLE9BQU8sQ0FBQyxFQUFFLEVBQUV2RDtvQkFDOUQsSUFBSTJELFdBQVdYLFVBQVVXO2dCQUMzQjtZQUNGO1FBQ0Y7UUFFQSwwREFBMEQ7UUFDMUQsSUFBSUM7UUFDSixJQUFJNUQsYUFBYXdCLE1BQU0sR0FBR3JELDBCQUEwQk8sTUFBTTtZQUN4RGtGLGVBQWUsTUFBTWpHLHVFQUFtQkEsQ0FBQ2U7UUFDM0M7UUFFQSxNQUFNbUYsV0FBMkI7WUFDL0JwRSxRQUFRTztZQUNSK0M7WUFDQUM7WUFDQWMsUUFBUTtnQkFDTjdDO2dCQUNBRTtnQkFDQSxHQUFJRCxjQUFjO29CQUFFQTtnQkFBWSxJQUFJLENBQUMsQ0FBQztZQUN4QztZQUNBLEdBQUkwQyxjQUFjcEMsU0FBUztnQkFBRW9DO1lBQWEsSUFBSSxDQUFDLENBQUM7UUFDbEQ7UUFDQSxPQUFPM0UsU0FBU1IsSUFBSSxDQUFDb0Y7SUFDdkIsRUFBRSxPQUFPeEIsS0FBSztRQUNaRixRQUFRRCxLQUFLLENBQUMsNEJBQTRCRztRQUMxQyxPQUFPcEQsU0FBU1IsSUFBSSxDQUNsQjtZQUFFUyxTQUFTbUQsZUFBZTBCLFFBQVExQixJQUFJbkQsT0FBTyxHQUFHO1FBQWdCLEdBQ2hFO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmluZHIvLi9hcHAvYXBpL3N1cHBseS1tYXAvc2VhcmNoL3JvdXRlLnRzP2JlNGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGZldGNoTmVhcmJ5U3RvcmVzIH0gZnJvbSAnQC9saWIvc3VwcGx5LW1hcC9vdmVycGFzcydcbmltcG9ydCB7IHJhbmtTdG9yZXMsIHN1bW1hcml6ZUJlc3RPcHRpb24sIHN1Z2dlc3RBbHRlcm5hdGl2ZXMgfSBmcm9tICdAL2xpYi9zdXBwbHktbWFwL2FpJ1xuaW1wb3J0IHsgZ2V0RmVlZGJhY2tGb3JTdG9yZXMsIGdldFByaWNlc0ZvclN0b3JlcyB9IGZyb20gJ0AvbGliL3N1cHBseS1tYXAvZmVlZGJhY2snXG5pbXBvcnQgeyBmb3JtYXRNaWxlcywgaGF2ZXJzaW5lS20gfSBmcm9tICdAL2xpYi9zdXBwbHktbWFwL2Rpc3RhbmNlJ1xuaW1wb3J0IHsgZ2V0Um9hZERpc3RhbmNlcyB9IGZyb20gJ0AvbGliL3N1cHBseS1tYXAvZ29vZ2xlLWRpc3RhbmNlJ1xuaW1wb3J0IHsgZ2V0Um9hZERpc3RhbmNlc09TUk0gfSBmcm9tICdAL2xpYi9zdXBwbHktbWFwL29zcm0tZGlzdGFuY2UnXG5cbmNvbnN0IFJBRElVU19NID0gNTAwMCAvLyA1IGttXG5jb25zdCBBTFRFUk5BVElWRVNfVEhSRVNIT0xEID0gMiAvLyBzdWdnZXN0IGFsdGVybmF0aXZlcyB3aGVuIHN0b3JlcyA8IHRoaXNcbmNvbnN0IE1BWF9ORUFSQllfU1RPUkVTID0gMTAgLy8gbnVtYmVyIG9mIHN0b3JlcyB0byByZXR1cm5cbmNvbnN0IE1BWF9TVE9SRVNfRk9SX1JPQUQgPSAyNSAvLyByZXF1ZXN0IHJvYWQgZGlzdGFuY2VzIGZvciBtb3JlIGNhbmRpZGF0ZXMgKEdvb2dsZS9PU1JNIGxpbWl0IGFsbG93cyAyNSlcblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hTdG9yZSB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIGxhdDogbnVtYmVyXG4gIGxuZzogbnVtYmVyXG4gIGFkZHJlc3M6IHN0cmluZ1xuICBkaXN0YW5jZUttOiBudW1iZXJcbiAgZHVyYXRpb25NaW51dGVzPzogbnVtYmVyXG4gIHJlcG9ydGVkUHJpY2U/OiBudW1iZXJcbiAgb3NtVGFncz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hSZXNwb25zZSB7XG4gIHN0b3JlczogU2VhcmNoU3RvcmVbXVxuICBiZXN0T3B0aW9uSWQ6IHN0cmluZ1xuICBzdW1tYXJ5OiBzdHJpbmdcbiAgYWx0ZXJuYXRpdmVzPzogc3RyaW5nW11cbiAgLyoqIERlYnVnOiBBUEkgY29ubmVjdGlvbiBhbmQgd2hpY2ggc291cmNlIHdhcyB1c2VkIGZvciBkaXN0YW5jZXMgKi9cbiAgX2RlYnVnPzoge1xuICAgIGRpc3RhbmNlU291cmNlOiAnZ29vZ2xlJyB8ICdvc3JtJyB8ICdoYXZlcnNpbmUnXG4gICAgZ29vZ2xlS2V5U2V0OiBib29sZWFuXG4gICAgLyoqIFJlYXNvbiBHb29nbGUgd2Fzbid0IHVzZWQgKG9ubHkgd2hlbiBkaXN0YW5jZVNvdXJjZSAhPT0gJ2dvb2dsZScpICovXG4gICAgZ29vZ2xlRXJyb3I/OiBzdHJpbmdcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IGl0ZW0gPSB0eXBlb2YgYm9keS5pdGVtID09PSAnc3RyaW5nJyA/IGJvZHkuaXRlbS50cmltKCkgOiAnJ1xuICAgIGNvbnN0IGxhdCA9IHR5cGVvZiBib2R5LmxhdCA9PT0gJ251bWJlcicgPyBib2R5LmxhdCA6IHBhcnNlRmxvYXQoYm9keS5sYXQpXG4gICAgY29uc3QgbG5nID0gdHlwZW9mIGJvZHkubG5nID09PSAnbnVtYmVyJyA/IGJvZHkubG5nIDogcGFyc2VGbG9hdChib2R5LmxuZylcblxuICAgIGlmICghaXRlbSB8fCBOdW1iZXIuaXNOYU4obGF0KSB8fCBOdW1iZXIuaXNOYU4obG5nKSkge1xuICAgICAgcmV0dXJuIFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgbWVzc2FnZTogJ01pc3Npbmcgb3IgaW52YWxpZCBpdGVtLCBsYXQsIG9yIGxuZycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3QgbWF4RGlzdGFuY2VLbSA9IGJvZHkuZmlsdGVycz8ubWF4RGlzdGFuY2VLbVxuICAgIGNvbnN0IHJhZGl1c00gPSBtYXhEaXN0YW5jZUttICE9IG51bGwgPyBNYXRoLm1pbihtYXhEaXN0YW5jZUttICogMTAwMCwgMjUwMDApIDogUkFESVVTX01cblxuICAgIGNvbnN0IHN0b3JlcyA9IGF3YWl0IGZldGNoTmVhcmJ5U3RvcmVzKGxhdCwgbG5nLCByYWRpdXNNKVxuICAgIGNvbnN0IGxpbWl0S20gPSBtYXhEaXN0YW5jZUttICE9IG51bGwgPyBtYXhEaXN0YW5jZUttIDogUkFESVVTX00gLyAxMDAwXG4gICAgY29uc3Qgc3RvcmVJZHMgPSBzdG9yZXMubWFwKChzKSA9PiBzLmlkKVxuICAgIGNvbnN0IHByaWNlcyA9IGdldFByaWNlc0ZvclN0b3JlcyhpdGVtLCBzdG9yZUlkcylcbiAgICBsZXQgc2VhcmNoU3RvcmVzOiBTZWFyY2hTdG9yZVtdID0gc3RvcmVzXG4gICAgICAuZmlsdGVyKChzKSA9PiBzLmRpc3RhbmNlS20gPD0gbGltaXRLbSlcbiAgICAgIC5tYXAoKHMpID0+ICh7XG4gICAgICAgIGlkOiBzLmlkLFxuICAgICAgICBuYW1lOiBzLm5hbWUsXG4gICAgICAgIGxhdDogcy5sYXQsXG4gICAgICAgIGxuZzogcy5sbmcsXG4gICAgICAgIGFkZHJlc3M6IHMuYWRkcmVzcyxcbiAgICAgICAgZGlzdGFuY2VLbTogTWF0aC5yb3VuZChoYXZlcnNpbmVLbShsYXQsIGxuZywgcy5sYXQsIHMubG5nKSAqIDEwMCkgLyAxMDAsXG4gICAgICAgIGR1cmF0aW9uTWludXRlczogdW5kZWZpbmVkLFxuICAgICAgICByZXBvcnRlZFByaWNlOiBwcmljZXNbcy5pZF0sXG4gICAgICAgIG9zbVRhZ3M6IHMub3NtVGFncyxcbiAgICAgIH0pKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGEuZGlzdGFuY2VLbSAtIGIuZGlzdGFuY2VLbSlcblxuICAgIGNvbnN0IHN0b3Jlc0ZvclJvYWQgPSBzZWFyY2hTdG9yZXMuc2xpY2UoMCwgTUFYX1NUT1JFU19GT1JfUk9BRClcbiAgICBjb25zdCBkZXN0cyA9IHN0b3Jlc0ZvclJvYWQubWFwKChzKSA9PiAoeyBsYXQ6IHMubGF0LCBsbmc6IHMubG5nIH0pKVxuICAgIGxldCByb2FkRGlzdGFuY2VzOiBBcnJheTx7IGRpc3RhbmNlS206IG51bWJlcjsgZHVyYXRpb25NaW51dGVzPzogbnVtYmVyIH0+IHwgbnVsbCA9IG51bGxcbiAgICBsZXQgZGlzdGFuY2VTb3VyY2U6ICdnb29nbGUnIHwgJ29zcm0nIHwgJ2hhdmVyc2luZScgPSAnaGF2ZXJzaW5lJ1xuICAgIGxldCBnb29nbGVFcnJvcjogc3RyaW5nIHwgdW5kZWZpbmVkXG4gICAgY29uc3QgZ29vZ2xlS2V5U2V0ID0gQm9vbGVhbihwcm9jZXNzLmVudi5HT09HTEVfTUFQU19BUElfS0VZKVxuICAgIGlmIChkZXN0cy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoZ29vZ2xlS2V5U2V0KSB7XG4gICAgICAgIGNvbnN0IGdvb2dsZVJlc3VsdCA9IGF3YWl0IGdldFJvYWREaXN0YW5jZXMoeyBsYXQsIGxuZyB9LCBkZXN0cylcbiAgICAgICAgaWYgKGdvb2dsZVJlc3VsdC5yZXN1bHRzKSB7XG4gICAgICAgICAgcm9hZERpc3RhbmNlcyA9IGdvb2dsZVJlc3VsdC5yZXN1bHRzXG4gICAgICAgICAgZGlzdGFuY2VTb3VyY2UgPSAnZ29vZ2xlJ1xuICAgICAgICAgIGNvbnN0IGhhc0dhcHMgPSByb2FkRGlzdGFuY2VzLnNvbWUoKHIpID0+IHIuZGlzdGFuY2VLbSA8PSAwKVxuICAgICAgICAgIGlmIChoYXNHYXBzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjb25zdCBvc3JtUmVzdWx0cyA9IGF3YWl0IGdldFJvYWREaXN0YW5jZXNPU1JNKHsgbGF0LCBsbmcgfSwgZGVzdHMpXG4gICAgICAgICAgICAgIGlmIChvc3JtUmVzdWx0cyAmJiBvc3JtUmVzdWx0cy5sZW5ndGggPT09IHJvYWREaXN0YW5jZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcm9hZERpc3RhbmNlcyA9IHJvYWREaXN0YW5jZXMubWFwKChnLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBvID0gb3NybVJlc3VsdHNbaV1cbiAgICAgICAgICAgICAgICAgIGlmIChnLmRpc3RhbmNlS20gPiAwKSByZXR1cm4gZ1xuICAgICAgICAgICAgICAgICAgaWYgKG8/LmRpc3RhbmNlS20gPiAwKSByZXR1cm4gb1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGdcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgLy8ga2VlcCBHb29nbGUgcmVzdWx0cyB3aXRoIGdhcHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ29vZ2xlRXJyb3IgPSBnb29nbGVSZXN1bHQuZXJyb3JcbiAgICAgICAgICBpZiAoZ29vZ2xlRXJyb3IpIGNvbnNvbGUud2FybignW1N1cHBseSBNYXBdIEdvb2dsZTonLCBnb29nbGVFcnJvcilcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ29vZ2xlRXJyb3IgPSAnR09PR0xFX01BUFNfQVBJX0tFWSBub3Qgc2V0J1xuICAgICAgICBjb25zb2xlLndhcm4oJ1tTdXBwbHkgTWFwXScsIGdvb2dsZUVycm9yKVxuICAgICAgfVxuICAgICAgaWYgKCFyb2FkRGlzdGFuY2VzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcm9hZERpc3RhbmNlcyA9IGF3YWl0IGdldFJvYWREaXN0YW5jZXNPU1JNKHsgbGF0LCBsbmcgfSwgZGVzdHMpXG4gICAgICAgICAgaWYgKHJvYWREaXN0YW5jZXMpIGRpc3RhbmNlU291cmNlID0gJ29zcm0nXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdXBwbHkgTWFwXSBPU1JNIHRocmV3OicsIGVycilcbiAgICAgICAgICByb2FkRGlzdGFuY2VzID0gbnVsbFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChyb2FkRGlzdGFuY2VzICYmIHJvYWREaXN0YW5jZXMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gV2hlbiBBUEkgcmV0dXJucyBkdXJhdGlvbiBidXQgZGlzdGFuY2U9MCAoZS5nLiBPU1JNIG51bGwgY2VsbCksIGVzdGltYXRlIGRpc3RhbmNlIGZyb20gZHJpdmUgdGltZVxuICAgICAgY29uc3QgQVZHX1NQRUVEX0tNSCA9IDUwXG4gICAgICBjb25zdCByb2FkQ291bnQgPSBNYXRoLm1pbihyb2FkRGlzdGFuY2VzLmxlbmd0aCwgc3RvcmVzRm9yUm9hZC5sZW5ndGgpXG4gICAgICBjb25zdCB3aXRoUm9hZCA9IHN0b3Jlc0ZvclJvYWQuc2xpY2UoMCwgcm9hZENvdW50KS5tYXAoKHMsIGkpID0+IHtcbiAgICAgICAgbGV0IHJvYWRLbSA9IHJvYWREaXN0YW5jZXMhW2ldLmRpc3RhbmNlS21cbiAgICAgICAgY29uc3QgZHVyYXRpb25NaW4gPSByb2FkRGlzdGFuY2VzIVtpXS5kdXJhdGlvbk1pbnV0ZXNcbiAgICAgICAgaWYgKHJvYWRLbSA8PSAwICYmIGR1cmF0aW9uTWluICE9IG51bGwgJiYgZHVyYXRpb25NaW4gPiAwKSB7XG4gICAgICAgICAgcm9hZEttID0gTWF0aC5yb3VuZCgoZHVyYXRpb25NaW4gLyA2MCkgKiBBVkdfU1BFRURfS01IICogMTAwKSAvIDEwMFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0cmFpZ2h0S20gPSBoYXZlcnNpbmVLbShsYXQsIGxuZywgcy5sYXQsIHMubG5nKVxuICAgICAgICAvLyBSb2FkIGRpc3RhbmNlIG11c3QgYmUgPj0gc3RyYWlnaHQtbGluZTsgaWYgQVBJIHJldHVybnMgbm9uc2Vuc2UsIHJlamVjdFxuICAgICAgICBjb25zdCB1c2VSb2FkID1cbiAgICAgICAgICByb2FkS20gPiAwICYmXG4gICAgICAgICAgcm9hZEttID49IHN0cmFpZ2h0S20gKiAwLjUgJiZcbiAgICAgICAgICByb2FkS20gPD0gc3RyYWlnaHRLbSAqIDE1XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucyxcbiAgICAgICAgICBkaXN0YW5jZUttOiB1c2VSb2FkID8gcm9hZEttIDogMCxcbiAgICAgICAgICBkdXJhdGlvbk1pbnV0ZXM6IHVzZVJvYWQgPyBkdXJhdGlvbk1pbiA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBoYWRBcGlWYWx1ZTogdXNlUm9hZCxcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC8vIE9ubHkgaW5jbHVkZSBzdG9yZXMgdGhhdCBoYXZlIGEgdmFsaWQgcm9hZCBBUEkgdmFsdWU7IGV4Y2x1ZGUgZmFsbGJhY2svaGF2ZXJzaW5lLW9ubHlcbiAgICAgIHNlYXJjaFN0b3JlcyA9IHdpdGhSb2FkXG4gICAgICAgIC5maWx0ZXIoKHMpID0+IHMuaGFkQXBpVmFsdWUgJiYgcy5kaXN0YW5jZUttID4gMCAmJiBzLmRpc3RhbmNlS20gPD0gbGltaXRLbSlcbiAgICAgICAgLm1hcCgoeyBoYWRBcGlWYWx1ZTogXywgLi4ucyB9KSA9PiBzKVxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5kaXN0YW5jZUttIC0gYi5kaXN0YW5jZUttKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBObyByb2FkIEFQSSBkYXRhOiBleGNsdWRlIGFsbCBzdG9yZXMgc28gd2UgZG9uJ3Qgc2hvdyBzdHJhaWdodC1saW5lIGVzdGltYXRlc1xuICAgICAgc2VhcmNoU3RvcmVzID0gW11cbiAgICB9XG4gICAgc2VhcmNoU3RvcmVzID0gc2VhcmNoU3RvcmVzLnNsaWNlKDAsIE1BWF9ORUFSQllfU1RPUkVTKVxuXG4gICAgbGV0IGJlc3RPcHRpb25JZCA9IHNlYXJjaFN0b3Jlcy5sZW5ndGggPiAwID8gc2VhcmNoU3RvcmVzWzBdLmlkIDogJydcbiAgICBsZXQgc3VtbWFyeSA9XG4gICAgICBzZWFyY2hTdG9yZXMubGVuZ3RoID4gMFxuICAgICAgICA/IGAke3NlYXJjaFN0b3Jlc1swXS5uYW1lfSBpcyB0aGUgY2xvc2VzdCBvcHRpb24gKCR7Zm9ybWF0TWlsZXMoc2VhcmNoU3RvcmVzWzBdLmRpc3RhbmNlS20pfSBhd2F5KS5gXG4gICAgICAgIDogJ05vIG5lYXJieSBzdG9yZXMgZm91bmQuJ1xuXG4gICAgLy8gUGhhc2UgMjogQUkgcmFua2luZyBhbmQgc3VtbWFyeSB3aGVuIE9QRU5BSV9BUElfS0VZIGlzIHNldCAodXNlcyBzdG9jayArIHByaWNlIHdoZW4gYXZhaWxhYmxlKVxuICAgIGlmIChwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSAmJiBzZWFyY2hTdG9yZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgZmVlZGJhY2sgPSBnZXRGZWVkYmFja0ZvclN0b3JlcyhpdGVtLCBzZWFyY2hTdG9yZXMubWFwKChzKSA9PiBzLmlkKSlcbiAgICAgIGNvbnN0IHJhbmtSZXN1bHQgPSBhd2FpdCByYW5rU3RvcmVzKGl0ZW0sIHNlYXJjaFN0b3JlcywgZmVlZGJhY2spXG4gICAgICBpZiAocmFua1Jlc3VsdD8ub3JkZXJlZElkcz8ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGlkVG9TdG9yZSA9IG5ldyBNYXAoc2VhcmNoU3RvcmVzLm1hcCgocykgPT4gW3MuaWQsIHNdKSlcbiAgICAgICAgY29uc3Qgb3JkZXJlZCA9IHJhbmtSZXN1bHQub3JkZXJlZElkc1xuICAgICAgICAgIC5tYXAoKGlkKSA9PiBpZFRvU3RvcmUuZ2V0KGlkKSlcbiAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pIGFzIFNlYXJjaFN0b3JlW11cbiAgICAgICAgaWYgKG9yZGVyZWQubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3QgcmVzdCA9IHNlYXJjaFN0b3Jlcy5maWx0ZXIoKHMpID0+ICFyYW5rUmVzdWx0Lm9yZGVyZWRJZHMhLmluY2x1ZGVzKHMuaWQpKVxuICAgICAgICAgIHNlYXJjaFN0b3JlcyA9IFsuLi5vcmRlcmVkLCAuLi5yZXN0XVxuICAgICAgICAgIGJlc3RPcHRpb25JZCA9IG9yZGVyZWRbMF0uaWRcbiAgICAgICAgICBjb25zdCBhaVN1bW1hcnkgPSBhd2FpdCBzdW1tYXJpemVCZXN0T3B0aW9uKGl0ZW0sIG9yZGVyZWRbMF0sIHNlYXJjaFN0b3JlcylcbiAgICAgICAgICBpZiAoYWlTdW1tYXJ5KSBzdW1tYXJ5ID0gYWlTdW1tYXJ5XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBQaGFzZSAzOiBhbHRlcm5hdGl2ZSBzdWdnZXN0aW9ucyB3aGVuIG5vIG9yIGZldyByZXN1bHRzXG4gICAgbGV0IGFsdGVybmF0aXZlczogc3RyaW5nW10gfCB1bmRlZmluZWRcbiAgICBpZiAoc2VhcmNoU3RvcmVzLmxlbmd0aCA8IEFMVEVSTkFUSVZFU19USFJFU0hPTEQgJiYgaXRlbSkge1xuICAgICAgYWx0ZXJuYXRpdmVzID0gYXdhaXQgc3VnZ2VzdEFsdGVybmF0aXZlcyhpdGVtKVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlOiBTZWFyY2hSZXNwb25zZSA9IHtcbiAgICAgIHN0b3Jlczogc2VhcmNoU3RvcmVzLFxuICAgICAgYmVzdE9wdGlvbklkLFxuICAgICAgc3VtbWFyeSxcbiAgICAgIF9kZWJ1Zzoge1xuICAgICAgICBkaXN0YW5jZVNvdXJjZSxcbiAgICAgICAgZ29vZ2xlS2V5U2V0LFxuICAgICAgICAuLi4oZ29vZ2xlRXJyb3IgPyB7IGdvb2dsZUVycm9yIH0gOiB7fSksXG4gICAgICB9LFxuICAgICAgLi4uKGFsdGVybmF0aXZlcz8ubGVuZ3RoID8geyBhbHRlcm5hdGl2ZXMgfSA6IHt9KSxcbiAgICB9XG4gICAgcmV0dXJuIFJlc3BvbnNlLmpzb24ocmVzcG9uc2UpXG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1N1cHBseSBtYXAgc2VhcmNoIGVycm9yOicsIGVycilcbiAgICByZXR1cm4gUmVzcG9uc2UuanNvbihcbiAgICAgIHsgbWVzc2FnZTogZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdTZWFyY2ggZmFpbGVkJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibmFtZXMiOlsiZmV0Y2hOZWFyYnlTdG9yZXMiLCJyYW5rU3RvcmVzIiwic3VtbWFyaXplQmVzdE9wdGlvbiIsInN1Z2dlc3RBbHRlcm5hdGl2ZXMiLCJnZXRGZWVkYmFja0ZvclN0b3JlcyIsImdldFByaWNlc0ZvclN0b3JlcyIsImZvcm1hdE1pbGVzIiwiaGF2ZXJzaW5lS20iLCJnZXRSb2FkRGlzdGFuY2VzIiwiZ2V0Um9hZERpc3RhbmNlc09TUk0iLCJSQURJVVNfTSIsIkFMVEVSTkFUSVZFU19USFJFU0hPTEQiLCJNQVhfTkVBUkJZX1NUT1JFUyIsIk1BWF9TVE9SRVNfRk9SX1JPQUQiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwiaXRlbSIsInRyaW0iLCJsYXQiLCJwYXJzZUZsb2F0IiwibG5nIiwiTnVtYmVyIiwiaXNOYU4iLCJSZXNwb25zZSIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJtYXhEaXN0YW5jZUttIiwiZmlsdGVycyIsInJhZGl1c00iLCJNYXRoIiwibWluIiwic3RvcmVzIiwibGltaXRLbSIsInN0b3JlSWRzIiwibWFwIiwicyIsImlkIiwicHJpY2VzIiwic2VhcmNoU3RvcmVzIiwiZmlsdGVyIiwiZGlzdGFuY2VLbSIsIm5hbWUiLCJhZGRyZXNzIiwicm91bmQiLCJkdXJhdGlvbk1pbnV0ZXMiLCJ1bmRlZmluZWQiLCJyZXBvcnRlZFByaWNlIiwib3NtVGFncyIsInNvcnQiLCJhIiwiYiIsInN0b3Jlc0ZvclJvYWQiLCJzbGljZSIsImRlc3RzIiwicm9hZERpc3RhbmNlcyIsImRpc3RhbmNlU291cmNlIiwiZ29vZ2xlRXJyb3IiLCJnb29nbGVLZXlTZXQiLCJCb29sZWFuIiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9NQVBTX0FQSV9LRVkiLCJsZW5ndGgiLCJnb29nbGVSZXN1bHQiLCJyZXN1bHRzIiwiaGFzR2FwcyIsInNvbWUiLCJyIiwib3NybVJlc3VsdHMiLCJnIiwiaSIsIm8iLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyIiwiQVZHX1NQRUVEX0tNSCIsInJvYWRDb3VudCIsIndpdGhSb2FkIiwicm9hZEttIiwiZHVyYXRpb25NaW4iLCJzdHJhaWdodEttIiwidXNlUm9hZCIsImhhZEFwaVZhbHVlIiwiXyIsImJlc3RPcHRpb25JZCIsInN1bW1hcnkiLCJPUEVOQUlfQVBJX0tFWSIsImZlZWRiYWNrIiwicmFua1Jlc3VsdCIsIm9yZGVyZWRJZHMiLCJpZFRvU3RvcmUiLCJNYXAiLCJvcmRlcmVkIiwiZ2V0IiwicmVzdCIsImluY2x1ZGVzIiwiYWlTdW1tYXJ5IiwiYWx0ZXJuYXRpdmVzIiwicmVzcG9uc2UiLCJfZGVidWciLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/supply-map/search/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supply-map/ai.ts":
/*!******************************!*\
  !*** ./lib/supply-map/ai.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   rankStores: () => (/* binding */ rankStores),\n/* harmony export */   suggestAlternatives: () => (/* binding */ suggestAlternatives),\n/* harmony export */   summarizeBestOption: () => (/* binding */ summarizeBestOption)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _distance__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./distance */ \"(rsc)/./lib/supply-map/distance.ts\");\n/**\n * OpenAI helpers for Supply Map: rank stores, summarize best option, suggest alternatives.\n */ \n\nasync function rankStores(item, stores, feedback) {\n    const apiKey = process.env.OPENAI_API_KEY;\n    if (!apiKey || stores.length === 0) return null;\n    const client = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n        apiKey\n    });\n    const storeList = stores.map((s)=>{\n        const mi = (0,_distance__WEBPACK_IMPORTED_MODULE_1__.kmToMiles)(s.distanceKm);\n        const distStr = mi < 1 ? `${mi.toFixed(1)} mi` : `${Math.round(mi * 10) / 10} mi`;\n        const priceStr = s.reportedPrice != null ? `, reported price: $${s.reportedPrice.toFixed(2)}` : \"\";\n        return `- id: \"${s.id}\", name: \"${s.name}\", distance: ${distStr}${priceStr}${s.address ? `, address: ${s.address}` : \"\"}`;\n    }).join(\"\\n\");\n    const feedbackLine = feedback && Object.keys(feedback).length > 0 ? `\\nUser-reported stock for \"${item}\": ${Object.entries(feedback).map(([id, inStock])=>{\n        const name = stores.find((s)=>s.id === id)?.name ?? id;\n        return `${name} – ${inStock ? \"in stock\" : \"out of stock\"}`;\n    }).join(\"; \")}. Prefer stores reported in stock.\\n` : \"\";\n    const prompt = `The user is looking for: \"${item}\".${feedbackLine}\n\nNearby stores (with id, name, distance in miles):\n${storeList}\n\nDistances are in miles. When reported prices are shown, prefer lower price when similar distance. ${feedbackLine ? \"Account for user-reported stock when ranking.\" : \"\"} Rank by convenience, likely availability, and value (when price is reported). Return a JSON object with exactly:\n- \"orderedIds\": array of store ids in best-to-worst order (use the exact id strings from the list above)\n- \"reasons\": optional object mapping store id to a one-line reason (e.g. \"Closest and likely has stock\")\n\nReturn only valid JSON, no markdown or extra text.`;\n    try {\n        const completion = await client.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            temperature: 0.2,\n            max_tokens: 500\n        });\n        const text = completion.choices[0]?.message?.content?.trim();\n        if (!text) return null;\n        const parsed = JSON.parse(text);\n        const orderedIds = Array.isArray(parsed.orderedIds) ? parsed.orderedIds : [];\n        return {\n            orderedIds,\n            reasons: parsed.reasons ?? undefined\n        };\n    } catch  {\n        return null;\n    }\n}\nasync function summarizeBestOption(item, store, allStores) {\n    const apiKey = process.env.OPENAI_API_KEY;\n    if (!apiKey) return null;\n    const client = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n        apiKey\n    });\n    const mi = (0,_distance__WEBPACK_IMPORTED_MODULE_1__.kmToMiles)(store.distanceKm);\n    const distStr = mi < 1 ? `${mi.toFixed(1)} mi` : `${Math.round(mi * 10) / 10} mi`;\n    const priceContext = store.reportedPrice != null ? ` Reported price at this store: $${store.reportedPrice.toFixed(2)}.` : \"\";\n    const otherWithPrice = allStores?.filter((s)=>s.reportedPrice != null && s.id !== store.id) ?? [];\n    const comparisonContext = otherWithPrice.length > 0 ? ` Other reported prices: ${otherWithPrice.map((s)=>`${s.name} $${s.reportedPrice.toFixed(2)}`).join(\", \")}.` : \"\";\n    const prompt = `In 1–2 short sentences, explain why \"${store.name}\" (${distStr} away) is a good option for someone looking for \"${item}\".${priceContext}${comparisonContext} Use miles for distance. Only mention prices that are explicitly reported above; do not invent prices. No markdown, no quotes.`;\n    try {\n        const completion = await client.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            temperature: 0.3,\n            max_tokens: 80\n        });\n        const text = completion.choices[0]?.message?.content?.trim();\n        return text ?? null;\n    } catch  {\n        return null;\n    }\n}\nasync function suggestAlternatives(item) {\n    const apiKey = process.env.OPENAI_API_KEY;\n    if (!apiKey) return [];\n    const client = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n        apiKey\n    });\n    const prompt = `The user searched for \"${item}\" but found no or very few nearby results. Suggest 2–3 substitute products or store types they could try instead. Return a JSON object with a single key \"alternatives\" whose value is an array of short strings (e.g. [\"AA batteries\", \"general electronics store\"]). Return only valid JSON.`;\n    try {\n        const completion = await client.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ],\n            temperature: 0.3,\n            max_tokens: 150\n        });\n        const text = completion.choices[0]?.message?.content?.trim();\n        if (!text) return [];\n        const parsed = JSON.parse(text);\n        return Array.isArray(parsed.alternatives) ? parsed.alternatives.slice(0, 3) : [];\n    } catch  {\n        return [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUFBRTtZQUM3Q1MsYUFBYTtZQUNiQyxZQUFZO1FBQ2Q7UUFDQSxNQUFNQyxPQUFPVixXQUFXVyxPQUFPLENBQUMsRUFBRSxFQUFFQyxTQUFTTCxTQUFTTTtRQUN0RCxPQUFPSCxRQUFRO0lBQ2pCLEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGO0FBRU8sZUFBZW1CLG9CQUFvQjVELElBQVk7SUFDcEQsTUFBTUcsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxjQUFjO0lBQ3pDLElBQUksQ0FBQ0gsUUFBUSxPQUFPLEVBQUU7SUFFdEIsTUFBTUssU0FBUyxJQUFJWCw4Q0FBTUEsQ0FBQztRQUFFTTtJQUFPO0lBQ25DLE1BQU0yQixTQUFTLENBQUMsdUJBQXVCLEVBQUU5QixLQUFLLDhSQUE4UixDQUFDO0lBRTdVLElBQUk7UUFDRixNQUFNK0IsYUFBYSxNQUFNdkIsT0FBT3dCLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxNQUFNLENBQUM7WUFDdERDLE9BQU87WUFDUEMsVUFBVTtnQkFBQztvQkFBRUMsTUFBTTtvQkFBUUMsU0FBU1I7Z0JBQU87YUFBRTtZQUM3Q1MsYUFBYTtZQUNiQyxZQUFZO1FBQ2Q7UUFDQSxNQUFNQyxPQUFPVixXQUFXVyxPQUFPLENBQUMsRUFBRSxFQUFFQyxTQUFTTCxTQUFTTTtRQUN0RCxJQUFJLENBQUNILE1BQU0sT0FBTyxFQUFFO1FBQ3BCLE1BQU1JLFNBQVNDLEtBQUtDLEtBQUssQ0FBQ047UUFDMUIsT0FBT1EsTUFBTUMsT0FBTyxDQUFDTCxPQUFPZ0IsWUFBWSxJQUFJaEIsT0FBT2dCLFlBQVksQ0FBQ0MsS0FBSyxDQUFDLEdBQUcsS0FBSyxFQUFFO0lBQ2xGLEVBQUUsT0FBTTtRQUNOLE9BQU8sRUFBRTtJQUNYO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9maW5kci8uL2xpYi9zdXBwbHktbWFwL2FpLnRzPzhkYWYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBPcGVuQUkgaGVscGVycyBmb3IgU3VwcGx5IE1hcDogcmFuayBzdG9yZXMsIHN1bW1hcml6ZSBiZXN0IG9wdGlvbiwgc3VnZ2VzdCBhbHRlcm5hdGl2ZXMuXG4gKi9cblxuaW1wb3J0IE9wZW5BSSBmcm9tICdvcGVuYWknXG5pbXBvcnQgeyBrbVRvTWlsZXMgfSBmcm9tICcuL2Rpc3RhbmNlJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0b3JlRm9yQUkge1xuICBpZDogc3RyaW5nXG4gIG5hbWU6IHN0cmluZ1xuICBhZGRyZXNzOiBzdHJpbmdcbiAgZGlzdGFuY2VLbTogbnVtYmVyXG4gIHJlcG9ydGVkUHJpY2U/OiBudW1iZXJcbiAgb3NtVGFncz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBSYW5rUmVzdWx0IHtcbiAgb3JkZXJlZElkczogc3RyaW5nW11cbiAgcmVhc29ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBGZWVkYmFja0VudHJ5IHtcbiAgc3RvcmVJZDogc3RyaW5nXG4gIGluU3RvY2s6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJhbmtTdG9yZXMoXG4gIGl0ZW06IHN0cmluZyxcbiAgc3RvcmVzOiBTdG9yZUZvckFJW10sXG4gIGZlZWRiYWNrPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj5cbik6IFByb21pc2U8UmFua1Jlc3VsdCB8IG51bGw+IHtcbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVlcbiAgaWYgKCFhcGlLZXkgfHwgc3RvcmVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGxcblxuICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHsgYXBpS2V5IH0pXG4gIGNvbnN0IHN0b3JlTGlzdCA9IHN0b3Jlc1xuICAgIC5tYXAoKHMpID0+IHtcbiAgICAgIGNvbnN0IG1pID0ga21Ub01pbGVzKHMuZGlzdGFuY2VLbSlcbiAgICAgIGNvbnN0IGRpc3RTdHIgPSBtaSA8IDEgPyBgJHttaS50b0ZpeGVkKDEpfSBtaWAgOiBgJHtNYXRoLnJvdW5kKG1pICogMTApIC8gMTB9IG1pYFxuICAgICAgY29uc3QgcHJpY2VTdHIgPSBzLnJlcG9ydGVkUHJpY2UgIT0gbnVsbCA/IGAsIHJlcG9ydGVkIHByaWNlOiAkJHtzLnJlcG9ydGVkUHJpY2UudG9GaXhlZCgyKX1gIDogJydcbiAgICAgIHJldHVybiBgLSBpZDogXCIke3MuaWR9XCIsIG5hbWU6IFwiJHtzLm5hbWV9XCIsIGRpc3RhbmNlOiAke2Rpc3RTdHJ9JHtwcmljZVN0cn0ke3MuYWRkcmVzcyA/IGAsIGFkZHJlc3M6ICR7cy5hZGRyZXNzfWAgOiAnJ31gXG4gICAgfSlcbiAgICAuam9pbignXFxuJylcblxuICBjb25zdCBmZWVkYmFja0xpbmUgPVxuICAgIGZlZWRiYWNrICYmIE9iamVjdC5rZXlzKGZlZWRiYWNrKS5sZW5ndGggPiAwXG4gICAgICA/IGBcXG5Vc2VyLXJlcG9ydGVkIHN0b2NrIGZvciBcIiR7aXRlbX1cIjogJHtPYmplY3QuZW50cmllcyhmZWVkYmFjaylcbiAgICAgICAgICAubWFwKChbaWQsIGluU3RvY2tdKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gc3RvcmVzLmZpbmQoKHMpID0+IHMuaWQgPT09IGlkKT8ubmFtZSA/PyBpZFxuICAgICAgICAgICAgcmV0dXJuIGAke25hbWV9IOKAkyAke2luU3RvY2sgPyAnaW4gc3RvY2snIDogJ291dCBvZiBzdG9jayd9YFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmpvaW4oJzsgJyl9LiBQcmVmZXIgc3RvcmVzIHJlcG9ydGVkIGluIHN0b2NrLlxcbmBcbiAgICAgIDogJydcblxuICBjb25zdCBwcm9tcHQgPSBgVGhlIHVzZXIgaXMgbG9va2luZyBmb3I6IFwiJHtpdGVtfVwiLiR7ZmVlZGJhY2tMaW5lfVxuXG5OZWFyYnkgc3RvcmVzICh3aXRoIGlkLCBuYW1lLCBkaXN0YW5jZSBpbiBtaWxlcyk6XG4ke3N0b3JlTGlzdH1cblxuRGlzdGFuY2VzIGFyZSBpbiBtaWxlcy4gV2hlbiByZXBvcnRlZCBwcmljZXMgYXJlIHNob3duLCBwcmVmZXIgbG93ZXIgcHJpY2Ugd2hlbiBzaW1pbGFyIGRpc3RhbmNlLiAke2ZlZWRiYWNrTGluZSA/ICdBY2NvdW50IGZvciB1c2VyLXJlcG9ydGVkIHN0b2NrIHdoZW4gcmFua2luZy4nIDogJyd9IFJhbmsgYnkgY29udmVuaWVuY2UsIGxpa2VseSBhdmFpbGFiaWxpdHksIGFuZCB2YWx1ZSAod2hlbiBwcmljZSBpcyByZXBvcnRlZCkuIFJldHVybiBhIEpTT04gb2JqZWN0IHdpdGggZXhhY3RseTpcbi0gXCJvcmRlcmVkSWRzXCI6IGFycmF5IG9mIHN0b3JlIGlkcyBpbiBiZXN0LXRvLXdvcnN0IG9yZGVyICh1c2UgdGhlIGV4YWN0IGlkIHN0cmluZ3MgZnJvbSB0aGUgbGlzdCBhYm92ZSlcbi0gXCJyZWFzb25zXCI6IG9wdGlvbmFsIG9iamVjdCBtYXBwaW5nIHN0b3JlIGlkIHRvIGEgb25lLWxpbmUgcmVhc29uIChlLmcuIFwiQ2xvc2VzdCBhbmQgbGlrZWx5IGhhcyBzdG9ja1wiKVxuXG5SZXR1cm4gb25seSB2YWxpZCBKU09OLCBubyBtYXJrZG93biBvciBleHRyYSB0ZXh0LmBcblxuICB0cnkge1xuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6ICdncHQtNG8tbWluaScsXG4gICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICB0ZW1wZXJhdHVyZTogMC4yLFxuICAgICAgbWF4X3Rva2VuczogNTAwLFxuICAgIH0pXG4gICAgY29uc3QgdGV4dCA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudD8udHJpbSgpXG4gICAgaWYgKCF0ZXh0KSByZXR1cm4gbnVsbFxuICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UodGV4dCkgYXMgeyBvcmRlcmVkSWRzPzogc3RyaW5nW107IHJlYXNvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICBjb25zdCBvcmRlcmVkSWRzID0gQXJyYXkuaXNBcnJheShwYXJzZWQub3JkZXJlZElkcykgPyBwYXJzZWQub3JkZXJlZElkcyA6IFtdXG4gICAgcmV0dXJuIHsgb3JkZXJlZElkcywgcmVhc29uczogcGFyc2VkLnJlYXNvbnMgPz8gdW5kZWZpbmVkIH1cbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3VtbWFyaXplQmVzdE9wdGlvbihcbiAgaXRlbTogc3RyaW5nLFxuICBzdG9yZTogU3RvcmVGb3JBSSxcbiAgYWxsU3RvcmVzPzogU3RvcmVGb3JBSVtdXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVlcbiAgaWYgKCFhcGlLZXkpIHJldHVybiBudWxsXG5cbiAgY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BSSh7IGFwaUtleSB9KVxuICBjb25zdCBtaSA9IGttVG9NaWxlcyhzdG9yZS5kaXN0YW5jZUttKVxuICBjb25zdCBkaXN0U3RyID0gbWkgPCAxID8gYCR7bWkudG9GaXhlZCgxKX0gbWlgIDogYCR7TWF0aC5yb3VuZChtaSAqIDEwKSAvIDEwfSBtaWBcbiAgY29uc3QgcHJpY2VDb250ZXh0ID1cbiAgICBzdG9yZS5yZXBvcnRlZFByaWNlICE9IG51bGxcbiAgICAgID8gYCBSZXBvcnRlZCBwcmljZSBhdCB0aGlzIHN0b3JlOiAkJHtzdG9yZS5yZXBvcnRlZFByaWNlLnRvRml4ZWQoMil9LmBcbiAgICAgIDogJydcbiAgY29uc3Qgb3RoZXJXaXRoUHJpY2UgPSBhbGxTdG9yZXM/LmZpbHRlcigocykgPT4gcy5yZXBvcnRlZFByaWNlICE9IG51bGwgJiYgcy5pZCAhPT0gc3RvcmUuaWQpID8/IFtdXG4gIGNvbnN0IGNvbXBhcmlzb25Db250ZXh0ID1cbiAgICBvdGhlcldpdGhQcmljZS5sZW5ndGggPiAwXG4gICAgICA/IGAgT3RoZXIgcmVwb3J0ZWQgcHJpY2VzOiAke290aGVyV2l0aFByaWNlLm1hcCgocykgPT4gYCR7cy5uYW1lfSAkJHtzLnJlcG9ydGVkUHJpY2UhLnRvRml4ZWQoMil9YCkuam9pbignLCAnKX0uYFxuICAgICAgOiAnJ1xuICBjb25zdCBwcm9tcHQgPSBgSW4gMeKAkzIgc2hvcnQgc2VudGVuY2VzLCBleHBsYWluIHdoeSBcIiR7c3RvcmUubmFtZX1cIiAoJHtkaXN0U3RyfSBhd2F5KSBpcyBhIGdvb2Qgb3B0aW9uIGZvciBzb21lb25lIGxvb2tpbmcgZm9yIFwiJHtpdGVtfVwiLiR7cHJpY2VDb250ZXh0fSR7Y29tcGFyaXNvbkNvbnRleHR9IFVzZSBtaWxlcyBmb3IgZGlzdGFuY2UuIE9ubHkgbWVudGlvbiBwcmljZXMgdGhhdCBhcmUgZXhwbGljaXRseSByZXBvcnRlZCBhYm92ZTsgZG8gbm90IGludmVudCBwcmljZXMuIE5vIG1hcmtkb3duLCBubyBxdW90ZXMuYFxuXG4gIHRyeSB7XG4gICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IGNsaWVudC5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogJ2dwdC00by1taW5pJyxcbiAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjMsXG4gICAgICBtYXhfdG9rZW5zOiA4MCxcbiAgICB9KVxuICAgIGNvbnN0IHRleHQgPSBjb21wbGV0aW9uLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQ/LnRyaW0oKVxuICAgIHJldHVybiB0ZXh0ID8/IG51bGxcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3VnZ2VzdEFsdGVybmF0aXZlcyhpdGVtOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZXG4gIGlmICghYXBpS2V5KSByZXR1cm4gW11cblxuICBjb25zdCBjbGllbnQgPSBuZXcgT3BlbkFJKHsgYXBpS2V5IH0pXG4gIGNvbnN0IHByb21wdCA9IGBUaGUgdXNlciBzZWFyY2hlZCBmb3IgXCIke2l0ZW19XCIgYnV0IGZvdW5kIG5vIG9yIHZlcnkgZmV3IG5lYXJieSByZXN1bHRzLiBTdWdnZXN0IDLigJMzIHN1YnN0aXR1dGUgcHJvZHVjdHMgb3Igc3RvcmUgdHlwZXMgdGhleSBjb3VsZCB0cnkgaW5zdGVhZC4gUmV0dXJuIGEgSlNPTiBvYmplY3Qgd2l0aCBhIHNpbmdsZSBrZXkgXCJhbHRlcm5hdGl2ZXNcIiB3aG9zZSB2YWx1ZSBpcyBhbiBhcnJheSBvZiBzaG9ydCBzdHJpbmdzIChlLmcuIFtcIkFBIGJhdHRlcmllc1wiLCBcImdlbmVyYWwgZWxlY3Ryb25pY3Mgc3RvcmVcIl0pLiBSZXR1cm4gb25seSB2YWxpZCBKU09OLmBcblxuICB0cnkge1xuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6ICdncHQtNG8tbWluaScsXG4gICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgbWF4X3Rva2VuczogMTUwLFxuICAgIH0pXG4gICAgY29uc3QgdGV4dCA9IGNvbXBsZXRpb24uY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudD8udHJpbSgpXG4gICAgaWYgKCF0ZXh0KSByZXR1cm4gW11cbiAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHRleHQpIGFzIHsgYWx0ZXJuYXRpdmVzPzogc3RyaW5nW10gfVxuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHBhcnNlZC5hbHRlcm5hdGl2ZXMpID8gcGFyc2VkLmFsdGVybmF0aXZlcy5zbGljZSgwLCAzKSA6IFtdXG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBbXVxuICB9XG59XG4iXSwibmFtZXMiOlsiT3BlbkFJIiwia21Ub01pbGVzIiwicmFua1N0b3JlcyIsIml0ZW0iLCJzdG9yZXMiLCJmZWVkYmFjayIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsImxlbmd0aCIsImNsaWVudCIsInN0b3JlTGlzdCIsIm1hcCIsInMiLCJtaSIsImRpc3RhbmNlS20iLCJkaXN0U3RyIiwidG9GaXhlZCIsIk1hdGgiLCJyb3VuZCIsInByaWNlU3RyIiwicmVwb3J0ZWRQcmljZSIsImlkIiwibmFtZSIsImFkZHJlc3MiLCJqb2luIiwiZmVlZGJhY2tMaW5lIiwiT2JqZWN0Iiwia2V5cyIsImVudHJpZXMiLCJpblN0b2NrIiwiZmluZCIsInByb21wdCIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJ0ZXh0IiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJ0cmltIiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwib3JkZXJlZElkcyIsIkFycmF5IiwiaXNBcnJheSIsInJlYXNvbnMiLCJ1bmRlZmluZWQiLCJzdW1tYXJpemVCZXN0T3B0aW9uIiwic3RvcmUiLCJhbGxTdG9yZXMiLCJwcmljZUNvbnRleHQiLCJvdGhlcldpdGhQcmljZSIsImZpbHRlciIsImNvbXBhcmlzb25Db250ZXh0Iiwic3VnZ2VzdEFsdGVybmF0aXZlcyIsImFsdGVybmF0aXZlcyIsInNsaWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supply-map/ai.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supply-map/distance.ts":
/*!************************************!*\
  !*** ./lib/supply-map/distance.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatDistance: () => (/* binding */ formatDistance),\n/* harmony export */   formatDistanceFromMiles: () => (/* binding */ formatDistanceFromMiles),\n/* harmony export */   formatMiles: () => (/* binding */ formatMiles),\n/* harmony export */   haversineKm: () => (/* binding */ haversineKm),\n/* harmony export */   kmToMiles: () => (/* binding */ kmToMiles),\n/* harmony export */   milesToKm: () => (/* binding */ milesToKm)\n/* harmony export */ });\nconst KM_TO_MILES = 0.621371;\nconst MILES_TO_KM = 1.60934;\nconst EARTH_RADIUS_KM = 6371;\n/**\n * Great-circle distance between two points (haversine) in km.\n */ function haversineKm(lat1, lng1, lat2, lng2) {\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLng = (lng2 - lng1) * Math.PI / 180;\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLng / 2) * Math.sin(dLng / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return EARTH_RADIUS_KM * c;\n}\nfunction kmToMiles(km) {\n    return km * KM_TO_MILES;\n}\nfunction milesToKm(mi) {\n    return mi * MILES_TO_KM;\n}\n/**\n * Format distance in km as a short miles string for display (e.g. \"1.2 mi\", \"0.5 mi\").\n */ function formatMiles(km) {\n    const mi = kmToMiles(km);\n    if (mi < 0.1) return \"< 0.1 mi\";\n    if (mi < 1) return `${mi.toFixed(1)} mi`;\n    if (mi < 10) return `${Math.round(mi * 10) / 10} mi`;\n    return `${Math.round(mi)} mi`;\n}\n/**\n * Format distance for display in the user's chosen unit.\n */ function formatDistance(km, unit) {\n    if (unit === \"km\") {\n        if (km < 0.1) return \"< 0.1 km\";\n        if (km < 1) return `${km.toFixed(1)} km`;\n        if (km < 10) return `${Math.round(km * 10) / 10} km`;\n        return `${Math.round(km)} km`;\n    }\n    return formatMiles(km);\n}\n/**\n * Format a distance given in miles (e.g. filter \"5 mi\") in the user's chosen unit.\n */ function formatDistanceFromMiles(miles, unit) {\n    if (unit === \"km\") {\n        const km = milesToKm(miles);\n        return km < 1 ? `${km.toFixed(1)} km` : `${Math.round(km)} km`;\n    }\n    return `${miles} mi`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwcGx5LW1hcC9kaXN0YW5jZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxNQUFNQSxjQUFjO0FBQ3BCLE1BQU1DLGNBQWM7QUFDcEIsTUFBTUMsa0JBQWtCO0FBRXhCOztDQUVDLEdBQ00sU0FBU0MsWUFDZEMsSUFBWSxFQUNaQyxJQUFZLEVBQ1pDLElBQVksRUFDWkMsSUFBWTtJQUVaLE1BQU1DLE9BQU8sQ0FBRUYsT0FBT0YsSUFBRyxJQUFLSyxLQUFLQyxFQUFFLEdBQUk7SUFDekMsTUFBTUMsT0FBTyxDQUFFSixPQUFPRixJQUFHLElBQUtJLEtBQUtDLEVBQUUsR0FBSTtJQUN6QyxNQUFNRSxJQUNKSCxLQUFLSSxHQUFHLENBQUNMLE9BQU8sS0FBS0MsS0FBS0ksR0FBRyxDQUFDTCxPQUFPLEtBQ3JDQyxLQUFLSyxHQUFHLENBQUMsT0FBUUwsS0FBS0MsRUFBRSxHQUFJLE9BQzFCRCxLQUFLSyxHQUFHLENBQUMsT0FBUUwsS0FBS0MsRUFBRSxHQUFJLE9BQzVCRCxLQUFLSSxHQUFHLENBQUNGLE9BQU8sS0FDaEJGLEtBQUtJLEdBQUcsQ0FBQ0YsT0FBTztJQUNwQixNQUFNSSxJQUFJLElBQUlOLEtBQUtPLEtBQUssQ0FBQ1AsS0FBS1EsSUFBSSxDQUFDTCxJQUFJSCxLQUFLUSxJQUFJLENBQUMsSUFBSUw7SUFDckQsT0FBT1Ysa0JBQWtCYTtBQUMzQjtBQUVPLFNBQVNHLFVBQVVDLEVBQVU7SUFDbEMsT0FBT0EsS0FBS25CO0FBQ2Q7QUFFTyxTQUFTb0IsVUFBVUMsRUFBVTtJQUNsQyxPQUFPQSxLQUFLcEI7QUFDZDtBQUVBOztDQUVDLEdBQ00sU0FBU3FCLFlBQVlILEVBQVU7SUFDcEMsTUFBTUUsS0FBS0gsVUFBVUM7SUFDckIsSUFBSUUsS0FBSyxLQUFLLE9BQU87SUFDckIsSUFBSUEsS0FBSyxHQUFHLE9BQU8sQ0FBQyxFQUFFQSxHQUFHRSxPQUFPLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDeEMsSUFBSUYsS0FBSyxJQUFJLE9BQU8sQ0FBQyxFQUFFWixLQUFLZSxLQUFLLENBQUNILEtBQUssTUFBTSxHQUFHLEdBQUcsQ0FBQztJQUNwRCxPQUFPLENBQUMsRUFBRVosS0FBS2UsS0FBSyxDQUFDSCxJQUFJLEdBQUcsQ0FBQztBQUMvQjtBQUlBOztDQUVDLEdBQ00sU0FBU0ksZUFBZU4sRUFBVSxFQUFFTyxJQUFrQjtJQUMzRCxJQUFJQSxTQUFTLE1BQU07UUFDakIsSUFBSVAsS0FBSyxLQUFLLE9BQU87UUFDckIsSUFBSUEsS0FBSyxHQUFHLE9BQU8sQ0FBQyxFQUFFQSxHQUFHSSxPQUFPLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDeEMsSUFBSUosS0FBSyxJQUFJLE9BQU8sQ0FBQyxFQUFFVixLQUFLZSxLQUFLLENBQUNMLEtBQUssTUFBTSxHQUFHLEdBQUcsQ0FBQztRQUNwRCxPQUFPLENBQUMsRUFBRVYsS0FBS2UsS0FBSyxDQUFDTCxJQUFJLEdBQUcsQ0FBQztJQUMvQjtJQUNBLE9BQU9HLFlBQVlIO0FBQ3JCO0FBRUE7O0NBRUMsR0FDTSxTQUFTUSx3QkFBd0JDLEtBQWEsRUFBRUYsSUFBa0I7SUFDdkUsSUFBSUEsU0FBUyxNQUFNO1FBQ2pCLE1BQU1QLEtBQUtDLFVBQVVRO1FBQ3JCLE9BQU9ULEtBQUssSUFBSSxDQUFDLEVBQUVBLEdBQUdJLE9BQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRWQsS0FBS2UsS0FBSyxDQUFDTCxJQUFJLEdBQUcsQ0FBQztJQUNoRTtJQUNBLE9BQU8sQ0FBQyxFQUFFUyxNQUFNLEdBQUcsQ0FBQztBQUN0QiIsInNvdXJjZXMiOlsid2VicGFjazovL2ZpbmRyLy4vbGliL3N1cHBseS1tYXAvZGlzdGFuY2UudHM/MmQzYiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBLTV9UT19NSUxFUyA9IDAuNjIxMzcxXG5jb25zdCBNSUxFU19UT19LTSA9IDEuNjA5MzRcbmNvbnN0IEVBUlRIX1JBRElVU19LTSA9IDYzNzFcblxuLyoqXG4gKiBHcmVhdC1jaXJjbGUgZGlzdGFuY2UgYmV0d2VlbiB0d28gcG9pbnRzIChoYXZlcnNpbmUpIGluIGttLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaGF2ZXJzaW5lS20oXG4gIGxhdDE6IG51bWJlcixcbiAgbG5nMTogbnVtYmVyLFxuICBsYXQyOiBudW1iZXIsXG4gIGxuZzI6IG51bWJlclxuKTogbnVtYmVyIHtcbiAgY29uc3QgZExhdCA9ICgobGF0MiAtIGxhdDEpICogTWF0aC5QSSkgLyAxODBcbiAgY29uc3QgZExuZyA9ICgobG5nMiAtIGxuZzEpICogTWF0aC5QSSkgLyAxODBcbiAgY29uc3QgYSA9XG4gICAgTWF0aC5zaW4oZExhdCAvIDIpICogTWF0aC5zaW4oZExhdCAvIDIpICtcbiAgICBNYXRoLmNvcygobGF0MSAqIE1hdGguUEkpIC8gMTgwKSAqXG4gICAgICBNYXRoLmNvcygobGF0MiAqIE1hdGguUEkpIC8gMTgwKSAqXG4gICAgICBNYXRoLnNpbihkTG5nIC8gMikgKlxuICAgICAgTWF0aC5zaW4oZExuZyAvIDIpXG4gIGNvbnN0IGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxIC0gYSkpXG4gIHJldHVybiBFQVJUSF9SQURJVVNfS00gKiBjXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBrbVRvTWlsZXMoa206IG51bWJlcik6IG51bWJlciB7XG4gIHJldHVybiBrbSAqIEtNX1RPX01JTEVTXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtaWxlc1RvS20obWk6IG51bWJlcik6IG51bWJlciB7XG4gIHJldHVybiBtaSAqIE1JTEVTX1RPX0tNXG59XG5cbi8qKlxuICogRm9ybWF0IGRpc3RhbmNlIGluIGttIGFzIGEgc2hvcnQgbWlsZXMgc3RyaW5nIGZvciBkaXNwbGF5IChlLmcuIFwiMS4yIG1pXCIsIFwiMC41IG1pXCIpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0TWlsZXMoa206IG51bWJlcik6IHN0cmluZyB7XG4gIGNvbnN0IG1pID0ga21Ub01pbGVzKGttKVxuICBpZiAobWkgPCAwLjEpIHJldHVybiAnPCAwLjEgbWknXG4gIGlmIChtaSA8IDEpIHJldHVybiBgJHttaS50b0ZpeGVkKDEpfSBtaWBcbiAgaWYgKG1pIDwgMTApIHJldHVybiBgJHtNYXRoLnJvdW5kKG1pICogMTApIC8gMTB9IG1pYFxuICByZXR1cm4gYCR7TWF0aC5yb3VuZChtaSl9IG1pYFxufVxuXG5leHBvcnQgdHlwZSBEaXN0YW5jZVVuaXQgPSAnbWknIHwgJ2ttJ1xuXG4vKipcbiAqIEZvcm1hdCBkaXN0YW5jZSBmb3IgZGlzcGxheSBpbiB0aGUgdXNlcidzIGNob3NlbiB1bml0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGlzdGFuY2Uoa206IG51bWJlciwgdW5pdDogRGlzdGFuY2VVbml0KTogc3RyaW5nIHtcbiAgaWYgKHVuaXQgPT09ICdrbScpIHtcbiAgICBpZiAoa20gPCAwLjEpIHJldHVybiAnPCAwLjEga20nXG4gICAgaWYgKGttIDwgMSkgcmV0dXJuIGAke2ttLnRvRml4ZWQoMSl9IGttYFxuICAgIGlmIChrbSA8IDEwKSByZXR1cm4gYCR7TWF0aC5yb3VuZChrbSAqIDEwKSAvIDEwfSBrbWBcbiAgICByZXR1cm4gYCR7TWF0aC5yb3VuZChrbSl9IGttYFxuICB9XG4gIHJldHVybiBmb3JtYXRNaWxlcyhrbSlcbn1cblxuLyoqXG4gKiBGb3JtYXQgYSBkaXN0YW5jZSBnaXZlbiBpbiBtaWxlcyAoZS5nLiBmaWx0ZXIgXCI1IG1pXCIpIGluIHRoZSB1c2VyJ3MgY2hvc2VuIHVuaXQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXREaXN0YW5jZUZyb21NaWxlcyhtaWxlczogbnVtYmVyLCB1bml0OiBEaXN0YW5jZVVuaXQpOiBzdHJpbmcge1xuICBpZiAodW5pdCA9PT0gJ2ttJykge1xuICAgIGNvbnN0IGttID0gbWlsZXNUb0ttKG1pbGVzKVxuICAgIHJldHVybiBrbSA8IDEgPyBgJHtrbS50b0ZpeGVkKDEpfSBrbWAgOiBgJHtNYXRoLnJvdW5kKGttKX0ga21gXG4gIH1cbiAgcmV0dXJuIGAke21pbGVzfSBtaWBcbn1cbiJdLCJuYW1lcyI6WyJLTV9UT19NSUxFUyIsIk1JTEVTX1RPX0tNIiwiRUFSVEhfUkFESVVTX0tNIiwiaGF2ZXJzaW5lS20iLCJsYXQxIiwibG5nMSIsImxhdDIiLCJsbmcyIiwiZExhdCIsIk1hdGgiLCJQSSIsImRMbmciLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImttVG9NaWxlcyIsImttIiwibWlsZXNUb0ttIiwibWkiLCJmb3JtYXRNaWxlcyIsInRvRml4ZWQiLCJyb3VuZCIsImZvcm1hdERpc3RhbmNlIiwidW5pdCIsImZvcm1hdERpc3RhbmNlRnJvbU1pbGVzIiwibWlsZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supply-map/distance.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supply-map/feedback.ts":
/*!************************************!*\
  !*** ./lib/supply-map/feedback.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getFeedbackForStores: () => (/* binding */ getFeedbackForStores),\n/* harmony export */   getPricesForStores: () => (/* binding */ getPricesForStores),\n/* harmony export */   setFeedback: () => (/* binding */ setFeedback),\n/* harmony export */   setPrice: () => (/* binding */ setPrice)\n/* harmony export */ });\n/**\n * In-memory store for crowd-sourced stock and price feedback (Phase 4).\n * Stock key: `${storeId}:${item}` → boolean.\n * Price key: `${storeId}:${item}` → number (USD).\n */ const feedbackStore = new Map();\nconst priceStore = new Map();\nfunction key(storeId, item) {\n    return `${storeId}:${item.trim().toLowerCase()}`;\n}\nfunction setFeedback(storeId, item, inStock) {\n    feedbackStore.set(key(storeId, item), inStock);\n}\nfunction setPrice(storeId, item, price) {\n    if (Number.isFinite(price) && price >= 0) {\n        priceStore.set(key(storeId, item), price);\n    }\n}\nfunction getFeedbackForStores(item, storeIds) {\n    const result = {};\n    const normalizedItem = item.trim().toLowerCase();\n    for (const id of storeIds){\n        const v = feedbackStore.get(`${id}:${normalizedItem}`);\n        if (v !== undefined) result[id] = v;\n    }\n    return result;\n}\nfunction getPricesForStores(item, storeIds) {\n    const result = {};\n    const normalizedItem = item.trim().toLowerCase();\n    for (const id of storeIds){\n        const v = priceStore.get(`${id}:${normalizedItem}`);\n        if (v !== undefined && Number.isFinite(v)) result[id] = v;\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwcGx5LW1hcC9mZWVkYmFjay50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7Q0FJQyxHQUVELE1BQU1BLGdCQUFnQixJQUFJQztBQUMxQixNQUFNQyxhQUFhLElBQUlEO0FBRXZCLFNBQVNFLElBQUlDLE9BQWUsRUFBRUMsSUFBWTtJQUN4QyxPQUFPLENBQUMsRUFBRUQsUUFBUSxDQUFDLEVBQUVDLEtBQUtDLElBQUksR0FBR0MsV0FBVyxHQUFHLENBQUM7QUFDbEQ7QUFFTyxTQUFTQyxZQUFZSixPQUFlLEVBQUVDLElBQVksRUFBRUksT0FBZ0I7SUFDekVULGNBQWNVLEdBQUcsQ0FBQ1AsSUFBSUMsU0FBU0MsT0FBT0k7QUFDeEM7QUFFTyxTQUFTRSxTQUFTUCxPQUFlLEVBQUVDLElBQVksRUFBRU8sS0FBYTtJQUNuRSxJQUFJQyxPQUFPQyxRQUFRLENBQUNGLFVBQVVBLFNBQVMsR0FBRztRQUN4Q1YsV0FBV1EsR0FBRyxDQUFDUCxJQUFJQyxTQUFTQyxPQUFPTztJQUNyQztBQUNGO0FBRU8sU0FBU0cscUJBQ2RWLElBQVksRUFDWlcsUUFBa0I7SUFFbEIsTUFBTUMsU0FBa0MsQ0FBQztJQUN6QyxNQUFNQyxpQkFBaUJiLEtBQUtDLElBQUksR0FBR0MsV0FBVztJQUM5QyxLQUFLLE1BQU1ZLE1BQU1ILFNBQVU7UUFDekIsTUFBTUksSUFBSXBCLGNBQWNxQixHQUFHLENBQUMsQ0FBQyxFQUFFRixHQUFHLENBQUMsRUFBRUQsZUFBZSxDQUFDO1FBQ3JELElBQUlFLE1BQU1FLFdBQVdMLE1BQU0sQ0FBQ0UsR0FBRyxHQUFHQztJQUNwQztJQUNBLE9BQU9IO0FBQ1Q7QUFFTyxTQUFTTSxtQkFDZGxCLElBQVksRUFDWlcsUUFBa0I7SUFFbEIsTUFBTUMsU0FBaUMsQ0FBQztJQUN4QyxNQUFNQyxpQkFBaUJiLEtBQUtDLElBQUksR0FBR0MsV0FBVztJQUM5QyxLQUFLLE1BQU1ZLE1BQU1ILFNBQVU7UUFDekIsTUFBTUksSUFBSWxCLFdBQVdtQixHQUFHLENBQUMsQ0FBQyxFQUFFRixHQUFHLENBQUMsRUFBRUQsZUFBZSxDQUFDO1FBQ2xELElBQUlFLE1BQU1FLGFBQWFULE9BQU9DLFFBQVEsQ0FBQ00sSUFBSUgsTUFBTSxDQUFDRSxHQUFHLEdBQUdDO0lBQzFEO0lBQ0EsT0FBT0g7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2ZpbmRyLy4vbGliL3N1cHBseS1tYXAvZmVlZGJhY2sudHM/YzBmNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEluLW1lbW9yeSBzdG9yZSBmb3IgY3Jvd2Qtc291cmNlZCBzdG9jayBhbmQgcHJpY2UgZmVlZGJhY2sgKFBoYXNlIDQpLlxuICogU3RvY2sga2V5OiBgJHtzdG9yZUlkfToke2l0ZW19YCDihpIgYm9vbGVhbi5cbiAqIFByaWNlIGtleTogYCR7c3RvcmVJZH06JHtpdGVtfWAg4oaSIG51bWJlciAoVVNEKS5cbiAqL1xuXG5jb25zdCBmZWVkYmFja1N0b3JlID0gbmV3IE1hcDxzdHJpbmcsIGJvb2xlYW4+KClcbmNvbnN0IHByaWNlU3RvcmUgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpXG5cbmZ1bmN0aW9uIGtleShzdG9yZUlkOiBzdHJpbmcsIGl0ZW06IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBgJHtzdG9yZUlkfToke2l0ZW0udHJpbSgpLnRvTG93ZXJDYXNlKCl9YFxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0RmVlZGJhY2soc3RvcmVJZDogc3RyaW5nLCBpdGVtOiBzdHJpbmcsIGluU3RvY2s6IGJvb2xlYW4pOiB2b2lkIHtcbiAgZmVlZGJhY2tTdG9yZS5zZXQoa2V5KHN0b3JlSWQsIGl0ZW0pLCBpblN0b2NrKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0UHJpY2Uoc3RvcmVJZDogc3RyaW5nLCBpdGVtOiBzdHJpbmcsIHByaWNlOiBudW1iZXIpOiB2b2lkIHtcbiAgaWYgKE51bWJlci5pc0Zpbml0ZShwcmljZSkgJiYgcHJpY2UgPj0gMCkge1xuICAgIHByaWNlU3RvcmUuc2V0KGtleShzdG9yZUlkLCBpdGVtKSwgcHJpY2UpXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZlZWRiYWNrRm9yU3RvcmVzKFxuICBpdGVtOiBzdHJpbmcsXG4gIHN0b3JlSWRzOiBzdHJpbmdbXVxuKTogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4ge1xuICBjb25zdCByZXN1bHQ6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+ID0ge31cbiAgY29uc3Qgbm9ybWFsaXplZEl0ZW0gPSBpdGVtLnRyaW0oKS50b0xvd2VyQ2FzZSgpXG4gIGZvciAoY29uc3QgaWQgb2Ygc3RvcmVJZHMpIHtcbiAgICBjb25zdCB2ID0gZmVlZGJhY2tTdG9yZS5nZXQoYCR7aWR9OiR7bm9ybWFsaXplZEl0ZW19YClcbiAgICBpZiAodiAhPT0gdW5kZWZpbmVkKSByZXN1bHRbaWRdID0gdlxuICB9XG4gIHJldHVybiByZXN1bHRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByaWNlc0ZvclN0b3JlcyhcbiAgaXRlbTogc3RyaW5nLFxuICBzdG9yZUlkczogc3RyaW5nW11cbik6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4ge1xuICBjb25zdCByZXN1bHQ6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fVxuICBjb25zdCBub3JtYWxpemVkSXRlbSA9IGl0ZW0udHJpbSgpLnRvTG93ZXJDYXNlKClcbiAgZm9yIChjb25zdCBpZCBvZiBzdG9yZUlkcykge1xuICAgIGNvbnN0IHYgPSBwcmljZVN0b3JlLmdldChgJHtpZH06JHtub3JtYWxpemVkSXRlbX1gKVxuICAgIGlmICh2ICE9PSB1bmRlZmluZWQgJiYgTnVtYmVyLmlzRmluaXRlKHYpKSByZXN1bHRbaWRdID0gdlxuICB9XG4gIHJldHVybiByZXN1bHRcbn1cbiJdLCJuYW1lcyI6WyJmZWVkYmFja1N0b3JlIiwiTWFwIiwicHJpY2VTdG9yZSIsImtleSIsInN0b3JlSWQiLCJpdGVtIiwidHJpbSIsInRvTG93ZXJDYXNlIiwic2V0RmVlZGJhY2siLCJpblN0b2NrIiwic2V0Iiwic2V0UHJpY2UiLCJwcmljZSIsIk51bWJlciIsImlzRmluaXRlIiwiZ2V0RmVlZGJhY2tGb3JTdG9yZXMiLCJzdG9yZUlkcyIsInJlc3VsdCIsIm5vcm1hbGl6ZWRJdGVtIiwiaWQiLCJ2IiwiZ2V0IiwidW5kZWZpbmVkIiwiZ2V0UHJpY2VzRm9yU3RvcmVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supply-map/feedback.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supply-map/google-distance.ts":
/*!*******************************************!*\
  !*** ./lib/supply-map/google-distance.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getRoadDistances: () => (/* binding */ getRoadDistances)\n/* harmony export */ });\n/**\n * Google Distance Matrix API – road distance and duration from one origin to many destinations.\n * Requires GOOGLE_MAPS_API_KEY and Distance Matrix API enabled.\n * Falls back to haversine when key is missing or API fails.\n */ const BASE_URL = \"https://maps.googleapis.com/maps/api/distancematrix/json\";\nconst MAX_DESTINATIONS_PER_REQUEST = 25 // stay under 100 elements (1 origin × N destinations)\n;\nconst MODE = \"driving\";\nconst FETCH_TIMEOUT_MS = 12000 // 12s per request\n;\n/**\n * Fetch road distances (and duration) from one origin to many destinations.\n * Returns { results, error } so callers can show why Google wasn't used when results is null.\n */ async function getRoadDistances(origin, destinations) {\n    const key = process.env.GOOGLE_MAPS_API_KEY;\n    if (!key || destinations.length === 0) {\n        return {\n            results: null,\n            error: !key ? \"GOOGLE_MAPS_API_KEY not set\" : \"No destinations\"\n        };\n    }\n    const originStr = `${origin.lat},${origin.lng}`;\n    const allResults = [];\n    for(let i = 0; i < destinations.length; i += MAX_DESTINATIONS_PER_REQUEST){\n        const chunk = destinations.slice(i, i + MAX_DESTINATIONS_PER_REQUEST);\n        const destStr = chunk.map((d)=>`${d.lat},${d.lng}`).join(\"|\");\n        const params = new URLSearchParams({\n            origins: originStr,\n            destinations: destStr,\n            mode: MODE,\n            key\n        });\n        const url = `${BASE_URL}?${params.toString()}`;\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), FETCH_TIMEOUT_MS);\n            const res = await fetch(url, {\n                signal: controller.signal\n            });\n            clearTimeout(timeoutId);\n            if (!res.ok) {\n                const err = `HTTP ${res.status}`;\n                console.error(\"[Supply Map] Google Distance Matrix\", err);\n                return {\n                    results: null,\n                    error: err\n                };\n            }\n            const data = await res.json();\n            if (data.status !== \"OK\" || !data.rows?.[0]?.elements) {\n                const err = [\n                    data.status,\n                    data.error_message\n                ].filter(Boolean).join(\" – \");\n                console.error(\"[Supply Map] Google Distance Matrix:\", err);\n                return {\n                    results: null,\n                    error: err\n                };\n            }\n            for (const el of data.rows[0].elements){\n                if (el.status !== \"OK\" || el.distance?.value == null) {\n                    allResults.push({\n                        distanceKm: 0,\n                        durationMinutes: undefined\n                    });\n                    continue;\n                }\n                // Google Distance Matrix: distance.value is always in meters (see API docs)\n                const distanceKm = Math.round(el.distance.value / 1000 * 100) / 100;\n                const durationMinutes = el.duration?.value != null ? Math.round(el.duration.value / 60) : undefined;\n                allResults.push({\n                    distanceKm,\n                    durationMinutes\n                });\n            }\n        } catch (err) {\n            const msg = err instanceof Error ? err.message : String(err);\n            console.error(\"[Supply Map] Google Distance Matrix request failed:\", err);\n            return {\n                results: null,\n                error: msg\n            };\n        }\n    }\n    if (allResults.length !== destinations.length) {\n        return {\n            results: null,\n            error: \"Result count mismatch\"\n        };\n    }\n    return {\n        results: allResults\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFNBQVMsT0FBT0ssS0FBS0MsS0FBSyxDQUFDUixHQUFHUyxRQUFRLENBQUNQLEtBQUssR0FBRyxNQUFNSTtnQkFDcEV4QyxXQUFXcUMsSUFBSSxDQUFDO29CQUFFQztvQkFBWUM7Z0JBQWdCO1lBQ2hEO1FBQ0YsRUFBRSxPQUFPZixLQUFLO1lBQ1osTUFBTW9CLE1BQU1wQixlQUFlcUIsUUFBUXJCLElBQUlzQixPQUFPLEdBQUdDLE9BQU92QjtZQUN4REUsUUFBUTlCLEtBQUssQ0FBQyx1REFBdUQ0QjtZQUNyRSxPQUFPO2dCQUFFN0IsU0FBUztnQkFBTUMsT0FBT2dEO1lBQUk7UUFDckM7SUFDRjtJQUVBLElBQUk1QyxXQUFXTixNQUFNLEtBQUtMLGFBQWFLLE1BQU0sRUFBRTtRQUM3QyxPQUFPO1lBQUVDLFNBQVM7WUFBTUMsT0FBTztRQUF3QjtJQUN6RDtJQUNBLE9BQU87UUFBRUQsU0FBU0s7SUFBVztBQUMvQiIsInNvdXJjZXMiOlsid2VicGFjazovL2ZpbmRyLy4vbGliL3N1cHBseS1tYXAvZ29vZ2xlLWRpc3RhbmNlLnRzPzRlMjciXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBHb29nbGUgRGlzdGFuY2UgTWF0cml4IEFQSSDigJMgcm9hZCBkaXN0YW5jZSBhbmQgZHVyYXRpb24gZnJvbSBvbmUgb3JpZ2luIHRvIG1hbnkgZGVzdGluYXRpb25zLlxuICogUmVxdWlyZXMgR09PR0xFX01BUFNfQVBJX0tFWSBhbmQgRGlzdGFuY2UgTWF0cml4IEFQSSBlbmFibGVkLlxuICogRmFsbHMgYmFjayB0byBoYXZlcnNpbmUgd2hlbiBrZXkgaXMgbWlzc2luZyBvciBBUEkgZmFpbHMuXG4gKi9cblxuY29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2Rpc3RhbmNlbWF0cml4L2pzb24nXG5jb25zdCBNQVhfREVTVElOQVRJT05TX1BFUl9SRVFVRVNUID0gMjUgLy8gc3RheSB1bmRlciAxMDAgZWxlbWVudHMgKDEgb3JpZ2luIMOXIE4gZGVzdGluYXRpb25zKVxuY29uc3QgTU9ERSA9ICdkcml2aW5nJ1xuY29uc3QgRkVUQ0hfVElNRU9VVF9NUyA9IDEyMDAwIC8vIDEycyBwZXIgcmVxdWVzdFxuXG5leHBvcnQgaW50ZXJmYWNlIFJvYWREaXN0YW5jZVJlc3VsdCB7XG4gIGRpc3RhbmNlS206IG51bWJlclxuICBkdXJhdGlvbk1pbnV0ZXM/OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHb29nbGVEaXN0YW5jZVJlc3VsdCB7XG4gIHJlc3VsdHM6IFJvYWREaXN0YW5jZVJlc3VsdFtdIHwgbnVsbFxuICAvKiogU2V0IHdoZW4gcmVzdWx0cyBpcyBudWxsIHNvIGNhbGxlcnMgY2FuIHNob3cgd2h5IChlLmcuIFJFUVVFU1RfREVOSUVELCBlcnJvcl9tZXNzYWdlKSAqL1xuICBlcnJvcj86IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgRGlzdGFuY2VNYXRyaXhFbGVtZW50IHtcbiAgc3RhdHVzOiBzdHJpbmdcbiAgZGlzdGFuY2U/OiB7IHZhbHVlOiBudW1iZXI7IHRleHQ6IHN0cmluZyB9XG4gIGR1cmF0aW9uPzogeyB2YWx1ZTogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfVxufVxuXG5pbnRlcmZhY2UgRGlzdGFuY2VNYXRyaXhSZXNwb25zZSB7XG4gIHN0YXR1czogc3RyaW5nXG4gIGVycm9yX21lc3NhZ2U/OiBzdHJpbmdcbiAgcm93cz86IEFycmF5PHsgZWxlbWVudHM6IERpc3RhbmNlTWF0cml4RWxlbWVudFtdIH0+XG59XG5cbi8qKlxuICogRmV0Y2ggcm9hZCBkaXN0YW5jZXMgKGFuZCBkdXJhdGlvbikgZnJvbSBvbmUgb3JpZ2luIHRvIG1hbnkgZGVzdGluYXRpb25zLlxuICogUmV0dXJucyB7IHJlc3VsdHMsIGVycm9yIH0gc28gY2FsbGVycyBjYW4gc2hvdyB3aHkgR29vZ2xlIHdhc24ndCB1c2VkIHdoZW4gcmVzdWx0cyBpcyBudWxsLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Um9hZERpc3RhbmNlcyhcbiAgb3JpZ2luOiB7IGxhdDogbnVtYmVyOyBsbmc6IG51bWJlciB9LFxuICBkZXN0aW5hdGlvbnM6IEFycmF5PHsgbGF0OiBudW1iZXI7IGxuZzogbnVtYmVyIH0+XG4pOiBQcm9taXNlPEdvb2dsZURpc3RhbmNlUmVzdWx0PiB7XG4gIGNvbnN0IGtleSA9IHByb2Nlc3MuZW52LkdPT0dMRV9NQVBTX0FQSV9LRVlcbiAgaWYgKCFrZXkgfHwgZGVzdGluYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB7IHJlc3VsdHM6IG51bGwsIGVycm9yOiAha2V5ID8gJ0dPT0dMRV9NQVBTX0FQSV9LRVkgbm90IHNldCcgOiAnTm8gZGVzdGluYXRpb25zJyB9XG4gIH1cblxuICBjb25zdCBvcmlnaW5TdHIgPSBgJHtvcmlnaW4ubGF0fSwke29yaWdpbi5sbmd9YFxuICBjb25zdCBhbGxSZXN1bHRzOiBSb2FkRGlzdGFuY2VSZXN1bHRbXSA9IFtdXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBkZXN0aW5hdGlvbnMubGVuZ3RoOyBpICs9IE1BWF9ERVNUSU5BVElPTlNfUEVSX1JFUVVFU1QpIHtcbiAgICBjb25zdCBjaHVuayA9IGRlc3RpbmF0aW9ucy5zbGljZShpLCBpICsgTUFYX0RFU1RJTkFUSU9OU19QRVJfUkVRVUVTVClcbiAgICBjb25zdCBkZXN0U3RyID0gY2h1bmsubWFwKChkKSA9PiBgJHtkLmxhdH0sJHtkLmxuZ31gKS5qb2luKCd8JylcbiAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgIG9yaWdpbnM6IG9yaWdpblN0cixcbiAgICAgIGRlc3RpbmF0aW9uczogZGVzdFN0cixcbiAgICAgIG1vZGU6IE1PREUsXG4gICAgICBrZXksXG4gICAgfSlcbiAgICBjb25zdCB1cmwgPSBgJHtCQVNFX1VSTH0/JHtwYXJhbXMudG9TdHJpbmcoKX1gXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIEZFVENIX1RJTUVPVVRfTVMpXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHsgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCB9KVxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZClcbiAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgIGNvbnN0IGVyciA9IGBIVFRQICR7cmVzLnN0YXR1c31gXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdXBwbHkgTWFwXSBHb29nbGUgRGlzdGFuY2UgTWF0cml4JywgZXJyKVxuICAgICAgICByZXR1cm4geyByZXN1bHRzOiBudWxsLCBlcnJvcjogZXJyIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IGRhdGEgPSAoYXdhaXQgcmVzLmpzb24oKSkgYXMgRGlzdGFuY2VNYXRyaXhSZXNwb25zZVxuICAgICAgaWYgKGRhdGEuc3RhdHVzICE9PSAnT0snIHx8ICFkYXRhLnJvd3M/LlswXT8uZWxlbWVudHMpIHtcbiAgICAgICAgY29uc3QgZXJyID0gW2RhdGEuc3RhdHVzLCBkYXRhLmVycm9yX21lc3NhZ2VdLmZpbHRlcihCb29sZWFuKS5qb2luKCcg4oCTICcpXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdXBwbHkgTWFwXSBHb29nbGUgRGlzdGFuY2UgTWF0cml4OicsIGVycilcbiAgICAgICAgcmV0dXJuIHsgcmVzdWx0czogbnVsbCwgZXJyb3I6IGVyciB9XG4gICAgICB9XG5cbiAgICAgIGZvciAoY29uc3QgZWwgb2YgZGF0YS5yb3dzWzBdLmVsZW1lbnRzKSB7XG4gICAgICAgIGlmIChlbC5zdGF0dXMgIT09ICdPSycgfHwgZWwuZGlzdGFuY2U/LnZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICBhbGxSZXN1bHRzLnB1c2goeyBkaXN0YW5jZUttOiAwLCBkdXJhdGlvbk1pbnV0ZXM6IHVuZGVmaW5lZCB9KVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cbiAgICAgICAgLy8gR29vZ2xlIERpc3RhbmNlIE1hdHJpeDogZGlzdGFuY2UudmFsdWUgaXMgYWx3YXlzIGluIG1ldGVycyAoc2VlIEFQSSBkb2NzKVxuICAgICAgICBjb25zdCBkaXN0YW5jZUttID0gTWF0aC5yb3VuZCgoZWwuZGlzdGFuY2UudmFsdWUgLyAxMDAwKSAqIDEwMCkgLyAxMDBcbiAgICAgICAgY29uc3QgZHVyYXRpb25NaW51dGVzID1cbiAgICAgICAgICBlbC5kdXJhdGlvbj8udmFsdWUgIT0gbnVsbCA/IE1hdGgucm91bmQoZWwuZHVyYXRpb24udmFsdWUgLyA2MCkgOiB1bmRlZmluZWRcbiAgICAgICAgYWxsUmVzdWx0cy5wdXNoKHsgZGlzdGFuY2VLbSwgZHVyYXRpb25NaW51dGVzIH0pXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zdCBtc2cgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogU3RyaW5nKGVycilcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTdXBwbHkgTWFwXSBHb29nbGUgRGlzdGFuY2UgTWF0cml4IHJlcXVlc3QgZmFpbGVkOicsIGVycilcbiAgICAgIHJldHVybiB7IHJlc3VsdHM6IG51bGwsIGVycm9yOiBtc2cgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChhbGxSZXN1bHRzLmxlbmd0aCAhPT0gZGVzdGluYXRpb25zLmxlbmd0aCkge1xuICAgIHJldHVybiB7IHJlc3VsdHM6IG51bGwsIGVycm9yOiAnUmVzdWx0IGNvdW50IG1pc21hdGNoJyB9XG4gIH1cbiAgcmV0dXJuIHsgcmVzdWx0czogYWxsUmVzdWx0cyB9XG59XG4iXSwibmFtZXMiOlsiQkFTRV9VUkwiLCJNQVhfREVTVElOQVRJT05TX1BFUl9SRVFVRVNUIiwiTU9ERSIsIkZFVENIX1RJTUVPVVRfTVMiLCJnZXRSb2FkRGlzdGFuY2VzIiwib3JpZ2luIiwiZGVzdGluYXRpb25zIiwia2V5IiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9NQVBTX0FQSV9LRVkiLCJsZW5ndGgiLCJyZXN1bHRzIiwiZXJyb3IiLCJvcmlnaW5TdHIiLCJsYXQiLCJsbmciLCJhbGxSZXN1bHRzIiwiaSIsImNodW5rIiwic2xpY2UiLCJkZXN0U3RyIiwibWFwIiwiZCIsImpvaW4iLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJvcmlnaW5zIiwibW9kZSIsInVybCIsInRvU3RyaW5nIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlcyIsImZldGNoIiwic2lnbmFsIiwiY2xlYXJUaW1lb3V0Iiwib2siLCJlcnIiLCJzdGF0dXMiLCJjb25zb2xlIiwiZGF0YSIsImpzb24iLCJyb3dzIiwiZWxlbWVudHMiLCJlcnJvcl9tZXNzYWdlIiwiZmlsdGVyIiwiQm9vbGVhbiIsImVsIiwiZGlzdGFuY2UiLCJ2YWx1ZSIsInB1c2giLCJkaXN0YW5jZUttIiwiZHVyYXRpb25NaW51dGVzIiwidW5kZWZpbmVkIiwiTWF0aCIsInJvdW5kIiwiZHVyYXRpb24iLCJtc2ciLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supply-map/google-distance.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supply-map/osrm-distance.ts":
/*!*****************************************!*\
  !*** ./lib/supply-map/osrm-distance.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getRoadDistancesOSRM: () => (/* binding */ getRoadDistancesOSRM)\n/* harmony export */ });\n/**\n * OSRM Table API – road distance and duration (driving) from one origin to many destinations.\n * Free, no API key. Uses public demo server: router.project-osrm.org\n * Coordinates: longitude,latitude (OSRM order).\n */ const OSRM_BASE = \"https://router.project-osrm.org/table/v1/driving\";\nconst MAX_DESTINATIONS_PER_REQUEST = 25;\nconst FETCH_TIMEOUT_MS = 12000 // 12s per request\n;\nasync function fetchOsrmChunk(origin, chunk) {\n    const coords = [\n        `${origin.lng},${origin.lat}`,\n        ...chunk.map((d)=>`${d.lng},${d.lat}`)\n    ].join(\";\");\n    const params = new URLSearchParams({\n        sources: \"0\",\n        destinations: Array.from({\n            length: chunk.length\n        }, (_, i)=>i + 1).join(\";\"),\n        annotations: \"duration,distance\"\n    });\n    const url = `${OSRM_BASE}/${coords}?${params.toString()}`;\n    const controller = new AbortController();\n    const timeoutId = setTimeout(()=>controller.abort(), FETCH_TIMEOUT_MS);\n    const res = await fetch(url, {\n        signal: controller.signal\n    });\n    clearTimeout(timeoutId);\n    if (!res.ok) return null;\n    const data = await res.json();\n    if (data.code !== \"Ok\" || !data.durations?.[0] || !data.distances?.[0]) return null;\n    const durations = data.durations[0];\n    const distances = data.distances[0];\n    if (durations.length !== chunk.length || distances.length !== chunk.length) return null;\n    // OSRM Table API: durations in seconds, distances in meters (row = source, col = destination).\n    // When no route is found, distance can be null but duration may still be present (or both null).\n    return durations.map((durationSec, i)=>{\n        const distMeters = distances[i];\n        const distanceKm = distMeters != null && Number.isFinite(distMeters) ? Math.round(distMeters / 1000 * 100) / 100 : 0;\n        const durationMinutes = durationSec != null && Number.isFinite(durationSec) ? Math.round(durationSec / 60) : undefined;\n        return {\n            distanceKm,\n            durationMinutes\n        };\n    });\n}\n/**\n * Fetch road distances (and duration) from one origin to many destinations via OSRM.\n * Free, no API key. Returns null if request fails or response is invalid.\n */ async function getRoadDistancesOSRM(origin, destinations) {\n    if (destinations.length === 0) return null;\n    const allResults = [];\n    for(let i = 0; i < destinations.length; i += MAX_DESTINATIONS_PER_REQUEST){\n        const chunk = destinations.slice(i, i + MAX_DESTINATIONS_PER_REQUEST);\n        const chunkResults = await fetchOsrmChunk(origin, chunk);\n        if (!chunkResults) return null;\n        allResults.push(...chunkResults);\n    }\n    return allResults;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwcGx5LW1hcC9vc3JtLWRpc3RhbmNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7OztDQUlDLEdBRUQsTUFBTUEsWUFBWTtBQUNsQixNQUFNQywrQkFBK0I7QUFDckMsTUFBTUMsbUJBQW1CLE1BQU0sa0JBQWtCOztBQWFqRCxlQUFlQyxlQUNiQyxNQUFvQyxFQUNwQ0MsS0FBMEM7SUFFMUMsTUFBTUMsU0FBUztRQUNiLENBQUMsRUFBRUYsT0FBT0csR0FBRyxDQUFDLENBQUMsRUFBRUgsT0FBT0ksR0FBRyxDQUFDLENBQUM7V0FDMUJILE1BQU1JLEdBQUcsQ0FBQyxDQUFDQyxJQUFNLENBQUMsRUFBRUEsRUFBRUgsR0FBRyxDQUFDLENBQUMsRUFBRUcsRUFBRUYsR0FBRyxDQUFDLENBQUM7S0FDeEMsQ0FBQ0csSUFBSSxDQUFDO0lBQ1AsTUFBTUMsU0FBUyxJQUFJQyxnQkFBZ0I7UUFDakNDLFNBQVM7UUFDVEMsY0FBY0MsTUFBTUMsSUFBSSxDQUFDO1lBQUVDLFFBQVFiLE1BQU1hLE1BQU07UUFBQyxHQUFHLENBQUNDLEdBQUdDLElBQU1BLElBQUksR0FBR1QsSUFBSSxDQUFDO1FBQ3pFVSxhQUFhO0lBQ2Y7SUFDQSxNQUFNQyxNQUFNLENBQUMsRUFBRXRCLFVBQVUsQ0FBQyxFQUFFTSxPQUFPLENBQUMsRUFBRU0sT0FBT1csUUFBUSxHQUFHLENBQUM7SUFFekQsTUFBTUMsYUFBYSxJQUFJQztJQUN2QixNQUFNQyxZQUFZQyxXQUFXLElBQU1ILFdBQVdJLEtBQUssSUFBSTFCO0lBQ3ZELE1BQU0yQixNQUFNLE1BQU1DLE1BQU1SLEtBQUs7UUFBRVMsUUFBUVAsV0FBV08sTUFBTTtJQUFDO0lBQ3pEQyxhQUFhTjtJQUNiLElBQUksQ0FBQ0csSUFBSUksRUFBRSxFQUFFLE9BQU87SUFDcEIsTUFBTUMsT0FBUSxNQUFNTCxJQUFJTSxJQUFJO0lBQzVCLElBQUlELEtBQUtFLElBQUksS0FBSyxRQUFRLENBQUNGLEtBQUtHLFNBQVMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDSCxLQUFLSSxTQUFTLEVBQUUsQ0FBQyxFQUFFLEVBQUUsT0FBTztJQUUvRSxNQUFNRCxZQUFZSCxLQUFLRyxTQUFTLENBQUMsRUFBRTtJQUNuQyxNQUFNQyxZQUFZSixLQUFLSSxTQUFTLENBQUMsRUFBRTtJQUNuQyxJQUFJRCxVQUFVbkIsTUFBTSxLQUFLYixNQUFNYSxNQUFNLElBQUlvQixVQUFVcEIsTUFBTSxLQUFLYixNQUFNYSxNQUFNLEVBQUUsT0FBTztJQUVuRiwrRkFBK0Y7SUFDL0YsaUdBQWlHO0lBQ2pHLE9BQU9tQixVQUFVNUIsR0FBRyxDQUFDLENBQUM4QixhQUFhbkI7UUFDakMsTUFBTW9CLGFBQWFGLFNBQVMsQ0FBQ2xCLEVBQUU7UUFDL0IsTUFBTXFCLGFBQWFELGNBQWMsUUFBUUUsT0FBT0MsUUFBUSxDQUFDSCxjQUNyREksS0FBS0MsS0FBSyxDQUFDLGFBQWMsT0FBUSxPQUFPLE1BQ3hDO1FBQ0osTUFBTUMsa0JBQ0pQLGVBQWUsUUFBUUcsT0FBT0MsUUFBUSxDQUFDSixlQUFlSyxLQUFLQyxLQUFLLENBQUNOLGNBQWMsTUFBTVE7UUFDdkYsT0FBTztZQUFFTjtZQUFZSztRQUFnQjtJQUN2QztBQUNGO0FBRUE7OztDQUdDLEdBQ00sZUFBZUUscUJBQ3BCNUMsTUFBb0MsRUFDcENXLFlBQWlEO0lBRWpELElBQUlBLGFBQWFHLE1BQU0sS0FBSyxHQUFHLE9BQU87SUFFdEMsTUFBTStCLGFBQW1DLEVBQUU7SUFDM0MsSUFBSyxJQUFJN0IsSUFBSSxHQUFHQSxJQUFJTCxhQUFhRyxNQUFNLEVBQUVFLEtBQUtuQiw2QkFBOEI7UUFDMUUsTUFBTUksUUFBUVUsYUFBYW1DLEtBQUssQ0FBQzlCLEdBQUdBLElBQUluQjtRQUN4QyxNQUFNa0QsZUFBZSxNQUFNaEQsZUFBZUMsUUFBUUM7UUFDbEQsSUFBSSxDQUFDOEMsY0FBYyxPQUFPO1FBQzFCRixXQUFXRyxJQUFJLElBQUlEO0lBQ3JCO0lBQ0EsT0FBT0Y7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2ZpbmRyLy4vbGliL3N1cHBseS1tYXAvb3NybS1kaXN0YW5jZS50cz9hMmZkIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogT1NSTSBUYWJsZSBBUEkg4oCTIHJvYWQgZGlzdGFuY2UgYW5kIGR1cmF0aW9uIChkcml2aW5nKSBmcm9tIG9uZSBvcmlnaW4gdG8gbWFueSBkZXN0aW5hdGlvbnMuXG4gKiBGcmVlLCBubyBBUEkga2V5LiBVc2VzIHB1YmxpYyBkZW1vIHNlcnZlcjogcm91dGVyLnByb2plY3Qtb3NybS5vcmdcbiAqIENvb3JkaW5hdGVzOiBsb25naXR1ZGUsbGF0aXR1ZGUgKE9TUk0gb3JkZXIpLlxuICovXG5cbmNvbnN0IE9TUk1fQkFTRSA9ICdodHRwczovL3JvdXRlci5wcm9qZWN0LW9zcm0ub3JnL3RhYmxlL3YxL2RyaXZpbmcnXG5jb25zdCBNQVhfREVTVElOQVRJT05TX1BFUl9SRVFVRVNUID0gMjVcbmNvbnN0IEZFVENIX1RJTUVPVVRfTVMgPSAxMjAwMCAvLyAxMnMgcGVyIHJlcXVlc3RcblxuZXhwb3J0IGludGVyZmFjZSBSb2FkRGlzdGFuY2VSZXN1bHQge1xuICBkaXN0YW5jZUttOiBudW1iZXJcbiAgZHVyYXRpb25NaW51dGVzPzogbnVtYmVyXG59XG5cbmludGVyZmFjZSBPU1JNVGFibGVSZXNwb25zZSB7XG4gIGNvZGU6IHN0cmluZ1xuICBkdXJhdGlvbnM/OiBudW1iZXJbXVtdXG4gIGRpc3RhbmNlcz86IG51bWJlcltdW11cbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hPc3JtQ2h1bmsoXG4gIG9yaWdpbjogeyBsYXQ6IG51bWJlcjsgbG5nOiBudW1iZXIgfSxcbiAgY2h1bms6IEFycmF5PHsgbGF0OiBudW1iZXI7IGxuZzogbnVtYmVyIH0+XG4pOiBQcm9taXNlPFJvYWREaXN0YW5jZVJlc3VsdFtdIHwgbnVsbD4ge1xuICBjb25zdCBjb29yZHMgPSBbXG4gICAgYCR7b3JpZ2luLmxuZ30sJHtvcmlnaW4ubGF0fWAsXG4gICAgLi4uY2h1bmsubWFwKChkKSA9PiBgJHtkLmxuZ30sJHtkLmxhdH1gKSxcbiAgXS5qb2luKCc7JylcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgc291cmNlczogJzAnLFxuICAgIGRlc3RpbmF0aW9uczogQXJyYXkuZnJvbSh7IGxlbmd0aDogY2h1bmsubGVuZ3RoIH0sIChfLCBpKSA9PiBpICsgMSkuam9pbignOycpLFxuICAgIGFubm90YXRpb25zOiAnZHVyYXRpb24sZGlzdGFuY2UnLFxuICB9KVxuICBjb25zdCB1cmwgPSBgJHtPU1JNX0JBU0V9LyR7Y29vcmRzfT8ke3BhcmFtcy50b1N0cmluZygpfWBcblxuICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpXG4gIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCBGRVRDSF9USU1FT1VUX01TKVxuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHsgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCB9KVxuICBjbGVhclRpbWVvdXQodGltZW91dElkKVxuICBpZiAoIXJlcy5vaykgcmV0dXJuIG51bGxcbiAgY29uc3QgZGF0YSA9IChhd2FpdCByZXMuanNvbigpKSBhcyBPU1JNVGFibGVSZXNwb25zZVxuICBpZiAoZGF0YS5jb2RlICE9PSAnT2snIHx8ICFkYXRhLmR1cmF0aW9ucz8uWzBdIHx8ICFkYXRhLmRpc3RhbmNlcz8uWzBdKSByZXR1cm4gbnVsbFxuXG4gIGNvbnN0IGR1cmF0aW9ucyA9IGRhdGEuZHVyYXRpb25zWzBdXG4gIGNvbnN0IGRpc3RhbmNlcyA9IGRhdGEuZGlzdGFuY2VzWzBdXG4gIGlmIChkdXJhdGlvbnMubGVuZ3RoICE9PSBjaHVuay5sZW5ndGggfHwgZGlzdGFuY2VzLmxlbmd0aCAhPT0gY2h1bmsubGVuZ3RoKSByZXR1cm4gbnVsbFxuXG4gIC8vIE9TUk0gVGFibGUgQVBJOiBkdXJhdGlvbnMgaW4gc2Vjb25kcywgZGlzdGFuY2VzIGluIG1ldGVycyAocm93ID0gc291cmNlLCBjb2wgPSBkZXN0aW5hdGlvbikuXG4gIC8vIFdoZW4gbm8gcm91dGUgaXMgZm91bmQsIGRpc3RhbmNlIGNhbiBiZSBudWxsIGJ1dCBkdXJhdGlvbiBtYXkgc3RpbGwgYmUgcHJlc2VudCAob3IgYm90aCBudWxsKS5cbiAgcmV0dXJuIGR1cmF0aW9ucy5tYXAoKGR1cmF0aW9uU2VjLCBpKSA9PiB7XG4gICAgY29uc3QgZGlzdE1ldGVycyA9IGRpc3RhbmNlc1tpXVxuICAgIGNvbnN0IGRpc3RhbmNlS20gPSBkaXN0TWV0ZXJzICE9IG51bGwgJiYgTnVtYmVyLmlzRmluaXRlKGRpc3RNZXRlcnMpXG4gICAgICA/IE1hdGgucm91bmQoKGRpc3RNZXRlcnMgLyAxMDAwKSAqIDEwMCkgLyAxMDBcbiAgICAgIDogMFxuICAgIGNvbnN0IGR1cmF0aW9uTWludXRlcyA9XG4gICAgICBkdXJhdGlvblNlYyAhPSBudWxsICYmIE51bWJlci5pc0Zpbml0ZShkdXJhdGlvblNlYykgPyBNYXRoLnJvdW5kKGR1cmF0aW9uU2VjIC8gNjApIDogdW5kZWZpbmVkXG4gICAgcmV0dXJuIHsgZGlzdGFuY2VLbSwgZHVyYXRpb25NaW51dGVzIH1cbiAgfSlcbn1cblxuLyoqXG4gKiBGZXRjaCByb2FkIGRpc3RhbmNlcyAoYW5kIGR1cmF0aW9uKSBmcm9tIG9uZSBvcmlnaW4gdG8gbWFueSBkZXN0aW5hdGlvbnMgdmlhIE9TUk0uXG4gKiBGcmVlLCBubyBBUEkga2V5LiBSZXR1cm5zIG51bGwgaWYgcmVxdWVzdCBmYWlscyBvciByZXNwb25zZSBpcyBpbnZhbGlkLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Um9hZERpc3RhbmNlc09TUk0oXG4gIG9yaWdpbjogeyBsYXQ6IG51bWJlcjsgbG5nOiBudW1iZXIgfSxcbiAgZGVzdGluYXRpb25zOiBBcnJheTx7IGxhdDogbnVtYmVyOyBsbmc6IG51bWJlciB9PlxuKTogUHJvbWlzZTxSb2FkRGlzdGFuY2VSZXN1bHRbXSB8IG51bGw+IHtcbiAgaWYgKGRlc3RpbmF0aW9ucy5sZW5ndGggPT09IDApIHJldHVybiBudWxsXG5cbiAgY29uc3QgYWxsUmVzdWx0czogUm9hZERpc3RhbmNlUmVzdWx0W10gPSBbXVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGRlc3RpbmF0aW9ucy5sZW5ndGg7IGkgKz0gTUFYX0RFU1RJTkFUSU9OU19QRVJfUkVRVUVTVCkge1xuICAgIGNvbnN0IGNodW5rID0gZGVzdGluYXRpb25zLnNsaWNlKGksIGkgKyBNQVhfREVTVElOQVRJT05TX1BFUl9SRVFVRVNUKVxuICAgIGNvbnN0IGNodW5rUmVzdWx0cyA9IGF3YWl0IGZldGNoT3NybUNodW5rKG9yaWdpbiwgY2h1bmspXG4gICAgaWYgKCFjaHVua1Jlc3VsdHMpIHJldHVybiBudWxsXG4gICAgYWxsUmVzdWx0cy5wdXNoKC4uLmNodW5rUmVzdWx0cylcbiAgfVxuICByZXR1cm4gYWxsUmVzdWx0c1xufVxuIl0sIm5hbWVzIjpbIk9TUk1fQkFTRSIsIk1BWF9ERVNUSU5BVElPTlNfUEVSX1JFUVVFU1QiLCJGRVRDSF9USU1FT1VUX01TIiwiZmV0Y2hPc3JtQ2h1bmsiLCJvcmlnaW4iLCJjaHVuayIsImNvb3JkcyIsImxuZyIsImxhdCIsIm1hcCIsImQiLCJqb2luIiwicGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwic291cmNlcyIsImRlc3RpbmF0aW9ucyIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsIl8iLCJpIiwiYW5ub3RhdGlvbnMiLCJ1cmwiLCJ0b1N0cmluZyIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0SWQiLCJzZXRUaW1lb3V0IiwiYWJvcnQiLCJyZXMiLCJmZXRjaCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsIm9rIiwiZGF0YSIsImpzb24iLCJjb2RlIiwiZHVyYXRpb25zIiwiZGlzdGFuY2VzIiwiZHVyYXRpb25TZWMiLCJkaXN0TWV0ZXJzIiwiZGlzdGFuY2VLbSIsIk51bWJlciIsImlzRmluaXRlIiwiTWF0aCIsInJvdW5kIiwiZHVyYXRpb25NaW51dGVzIiwidW5kZWZpbmVkIiwiZ2V0Um9hZERpc3RhbmNlc09TUk0iLCJhbGxSZXN1bHRzIiwic2xpY2UiLCJjaHVua1Jlc3VsdHMiLCJwdXNoIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supply-map/osrm-distance.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supply-map/overpass.ts":
/*!************************************!*\
  !*** ./lib/supply-map/overpass.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchNearbyStores: () => (/* binding */ fetchNearbyStores)\n/* harmony export */ });\n/* harmony import */ var _distance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./distance */ \"(rsc)/./lib/supply-map/distance.ts\");\n/**\n * Overpass API wrapper for Supply Map.\n * Fetches nearby shops and amenities (POIs) by radius.\n * See: https://wiki.openstreetmap.org/wiki/Overpass_API\n */ \nconst OVERPASS_BASE = \"https://overpass-api.de/api/interpreter\";\nconst DEFAULT_RADIUS_M = 5000 // 5 km\n;\nconst FETCH_TIMEOUT_MS = 20000 // 20s\n;\nfunction getDisplayName(element) {\n    return element.tags?.name ?? element.tags?.brand ?? \"Unnamed store\";\n}\nfunction getAddress(element) {\n    const t = element.tags;\n    if (!t) return \"\";\n    const parts = [\n        t[\"addr:street\"],\n        t[\"addr:housenumber\"] ? `${t[\"addr:housenumber\"]}` : null,\n        t[\"addr:city\"] ?? t[\"addr:town\"] ?? t[\"addr:village\"],\n        t[\"addr:state\"],\n        t[\"addr:postcode\"]\n    ].filter(Boolean);\n    return parts.join(\", \") || \"\";\n}\nasync function fetchNearbyStores(lat, lng, radiusM = DEFAULT_RADIUS_M) {\n    // Query shops and key amenities (supermarket, convenience, pharmacy, etc.)\n    const query = `\n[out:json][timeout:12];\n(\n  nwr[\"shop\"](around:${radiusM},${lat},${lng});\n  nwr[\"amenity\"~\"marketplace|pharmacy|fuel\"](around:${radiusM},${lat},${lng});\n);\nout center;\n  `.trim();\n    const controller = new AbortController();\n    const timeoutId = setTimeout(()=>controller.abort(), FETCH_TIMEOUT_MS);\n    const res = await fetch(OVERPASS_BASE, {\n        method: \"POST\",\n        body: query,\n        headers: {\n            \"Content-Type\": \"text/plain\"\n        },\n        signal: controller.signal\n    });\n    clearTimeout(timeoutId);\n    if (!res.ok) throw new Error(`Overpass request failed: ${res.status}`);\n    const data = await res.json();\n    const elements = data.elements ?? [];\n    const stores = [];\n    const seen = new Set();\n    for (const el of elements){\n        const elLat = el.lat ?? el.center?.lat;\n        const elLng = el.lon ?? el.center?.lon;\n        if (elLat == null || elLng == null) continue;\n        const id = `${el.type}/${el.id}`;\n        if (seen.has(id)) continue;\n        seen.add(id);\n        const name = getDisplayName(el);\n        const address = getAddress(el);\n        const distanceKm = (0,_distance__WEBPACK_IMPORTED_MODULE_0__.haversineKm)(lat, lng, elLat, elLng);\n        stores.push({\n            id,\n            name,\n            lat: elLat,\n            lng: elLng,\n            address,\n            distanceKm: Math.round(distanceKm * 100) / 100,\n            osmTags: el.tags\n        });\n    }\n    stores.sort((a, b)=>a.distanceKm - b.distanceKm);\n    return stores;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0IsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELEVBQUVOLFVBQVUsR0FBR08sRUFBRVAsVUFBVTtJQUNqRCxPQUFPYjtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmluZHIvLi9saWIvc3VwcGx5LW1hcC9vdmVycGFzcy50cz9jYWJhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogT3ZlcnBhc3MgQVBJIHdyYXBwZXIgZm9yIFN1cHBseSBNYXAuXG4gKiBGZXRjaGVzIG5lYXJieSBzaG9wcyBhbmQgYW1lbml0aWVzIChQT0lzKSBieSByYWRpdXMuXG4gKiBTZWU6IGh0dHBzOi8vd2lraS5vcGVuc3RyZWV0bWFwLm9yZy93aWtpL092ZXJwYXNzX0FQSVxuICovXG5cbmltcG9ydCB7IGhhdmVyc2luZUttIH0gZnJvbSAnLi9kaXN0YW5jZSdcblxuY29uc3QgT1ZFUlBBU1NfQkFTRSA9ICdodHRwczovL292ZXJwYXNzLWFwaS5kZS9hcGkvaW50ZXJwcmV0ZXInXG5jb25zdCBERUZBVUxUX1JBRElVU19NID0gNTAwMCAvLyA1IGttXG5jb25zdCBGRVRDSF9USU1FT1VUX01TID0gMjAwMDAgLy8gMjBzXG5cbmV4cG9ydCBpbnRlcmZhY2UgT3ZlcnBhc3NTdG9yZSB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIGxhdDogbnVtYmVyXG4gIGxuZzogbnVtYmVyXG4gIGFkZHJlc3M6IHN0cmluZ1xuICBkaXN0YW5jZUttOiBudW1iZXJcbiAgb3NtVGFncz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUoZWxlbWVudDogT3ZlcnBhc3NFbGVtZW50KTogc3RyaW5nIHtcbiAgcmV0dXJuIGVsZW1lbnQudGFncz8ubmFtZSA/PyBlbGVtZW50LnRhZ3M/LmJyYW5kID8/ICdVbm5hbWVkIHN0b3JlJ1xufVxuXG5mdW5jdGlvbiBnZXRBZGRyZXNzKGVsZW1lbnQ6IE92ZXJwYXNzRWxlbWVudCk6IHN0cmluZyB7XG4gIGNvbnN0IHQgPSBlbGVtZW50LnRhZ3NcbiAgaWYgKCF0KSByZXR1cm4gJydcbiAgY29uc3QgcGFydHMgPSBbXG4gICAgdFsnYWRkcjpzdHJlZXQnXSxcbiAgICB0WydhZGRyOmhvdXNlbnVtYmVyJ10gPyBgJHt0WydhZGRyOmhvdXNlbnVtYmVyJ119YCA6IG51bGwsXG4gICAgdFsnYWRkcjpjaXR5J10gPz8gdFsnYWRkcjp0b3duJ10gPz8gdFsnYWRkcjp2aWxsYWdlJ10sXG4gICAgdFsnYWRkcjpzdGF0ZSddLFxuICAgIHRbJ2FkZHI6cG9zdGNvZGUnXSxcbiAgXS5maWx0ZXIoQm9vbGVhbilcbiAgcmV0dXJuIHBhcnRzLmpvaW4oJywgJykgfHwgJydcbn1cblxuaW50ZXJmYWNlIE92ZXJwYXNzRWxlbWVudCB7XG4gIHR5cGU6IHN0cmluZ1xuICBpZDogbnVtYmVyXG4gIGxhdD86IG51bWJlclxuICBsb24/OiBudW1iZXJcbiAgY2VudGVyPzogeyBsYXQ6IG51bWJlcjsgbG9uOiBudW1iZXIgfVxuICB0YWdzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxufVxuXG5pbnRlcmZhY2UgT3ZlcnBhc3NSZXNwb25zZSB7XG4gIGVsZW1lbnRzOiBPdmVycGFzc0VsZW1lbnRbXVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hOZWFyYnlTdG9yZXMoXG4gIGxhdDogbnVtYmVyLFxuICBsbmc6IG51bWJlcixcbiAgcmFkaXVzTTogbnVtYmVyID0gREVGQVVMVF9SQURJVVNfTVxuKTogUHJvbWlzZTxPdmVycGFzc1N0b3JlW10+IHtcbiAgLy8gUXVlcnkgc2hvcHMgYW5kIGtleSBhbWVuaXRpZXMgKHN1cGVybWFya2V0LCBjb252ZW5pZW5jZSwgcGhhcm1hY3ksIGV0Yy4pXG4gIGNvbnN0IHF1ZXJ5ID0gYFxuW291dDpqc29uXVt0aW1lb3V0OjEyXTtcbihcbiAgbndyW1wic2hvcFwiXShhcm91bmQ6JHtyYWRpdXNNfSwke2xhdH0sJHtsbmd9KTtcbiAgbndyW1wiYW1lbml0eVwiflwibWFya2V0cGxhY2V8cGhhcm1hY3l8ZnVlbFwiXShhcm91bmQ6JHtyYWRpdXNNfSwke2xhdH0sJHtsbmd9KTtcbik7XG5vdXQgY2VudGVyO1xuICBgLnRyaW0oKVxuXG4gIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKClcbiAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIEZFVENIX1RJTUVPVVRfTVMpXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKE9WRVJQQVNTX0JBU0UsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBib2R5OiBxdWVyeSxcbiAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSxcbiAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxuICB9KVxuICBjbGVhclRpbWVvdXQodGltZW91dElkKVxuICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBPdmVycGFzcyByZXF1ZXN0IGZhaWxlZDogJHtyZXMuc3RhdHVzfWApXG4gIGNvbnN0IGRhdGEgPSAoYXdhaXQgcmVzLmpzb24oKSkgYXMgT3ZlcnBhc3NSZXNwb25zZVxuICBjb25zdCBlbGVtZW50cyA9IGRhdGEuZWxlbWVudHMgPz8gW11cblxuICBjb25zdCBzdG9yZXM6IE92ZXJwYXNzU3RvcmVbXSA9IFtdXG4gIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKVxuXG4gIGZvciAoY29uc3QgZWwgb2YgZWxlbWVudHMpIHtcbiAgICBjb25zdCBlbExhdCA9IGVsLmxhdCA/PyBlbC5jZW50ZXI/LmxhdFxuICAgIGNvbnN0IGVsTG5nID0gZWwubG9uID8/IGVsLmNlbnRlcj8ubG9uXG4gICAgaWYgKGVsTGF0ID09IG51bGwgfHwgZWxMbmcgPT0gbnVsbCkgY29udGludWVcbiAgICBjb25zdCBpZCA9IGAke2VsLnR5cGV9LyR7ZWwuaWR9YFxuICAgIGlmIChzZWVuLmhhcyhpZCkpIGNvbnRpbnVlXG4gICAgc2Vlbi5hZGQoaWQpXG4gICAgY29uc3QgbmFtZSA9IGdldERpc3BsYXlOYW1lKGVsKVxuICAgIGNvbnN0IGFkZHJlc3MgPSBnZXRBZGRyZXNzKGVsKVxuICAgIGNvbnN0IGRpc3RhbmNlS20gPSBoYXZlcnNpbmVLbShsYXQsIGxuZywgZWxMYXQsIGVsTG5nKVxuICAgIHN0b3Jlcy5wdXNoKHtcbiAgICAgIGlkLFxuICAgICAgbmFtZSxcbiAgICAgIGxhdDogZWxMYXQsXG4gICAgICBsbmc6IGVsTG5nLFxuICAgICAgYWRkcmVzcyxcbiAgICAgIGRpc3RhbmNlS206IE1hdGgucm91bmQoZGlzdGFuY2VLbSAqIDEwMCkgLyAxMDAsXG4gICAgICBvc21UYWdzOiBlbC50YWdzLFxuICAgIH0pXG4gIH1cblxuICBzdG9yZXMuc29ydCgoYSwgYikgPT4gYS5kaXN0YW5jZUttIC0gYi5kaXN0YW5jZUttKVxuICByZXR1cm4gc3RvcmVzXG59XG4iXSwibmFtZXMiOlsiaGF2ZXJzaW5lS20iLCJPVkVSUEFTU19CQVNFIiwiREVGQVVMVF9SQURJVVNfTSIsIkZFVENIX1RJTUVPVVRfTVMiLCJnZXREaXNwbGF5TmFtZSIsImVsZW1lbnQiLCJ0YWdzIiwibmFtZSIsImJyYW5kIiwiZ2V0QWRkcmVzcyIsInQiLCJwYXJ0cyIsImZpbHRlciIsIkJvb2xlYW4iLCJqb2luIiwiZmV0Y2hOZWFyYnlTdG9yZXMiLCJsYXQiLCJsbmciLCJyYWRpdXNNIiwicXVlcnkiLCJ0cmltIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsInJlcyIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsImhlYWRlcnMiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsIkVycm9yIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJlbGVtZW50cyIsInN0b3JlcyIsInNlZW4iLCJTZXQiLCJlbCIsImVsTGF0IiwiY2VudGVyIiwiZWxMbmciLCJsb24iLCJpZCIsInR5cGUiLCJoYXMiLCJhZGQiLCJhZGRyZXNzIiwiZGlzdGFuY2VLbSIsInB1c2giLCJNYXRoIiwicm91bmQiLCJvc21UYWdzIiwic29ydCIsImEiLCJiIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supply-map/overpass.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/openai"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsupply-map%2Fsearch%2Froute&page=%2Fapi%2Fsupply-map%2Fsearch%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsupply-map%2Fsearch%2Froute.ts&appDir=%2FUsers%2Flakshinjonnala%2FFindR%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Flakshinjonnala%2FFindR&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();